import{d as e,N as a,B as t,r as l,o,i as n,w as c,e as i,a as s,Z as d,H as u,t as r,j as p,c as m,I as f,l as g,a2 as v}from"./index-5vcJ2QQZ.js";import{E as b,a as S}from"./el-checkbox-DLONfMTE.js";/* empty css                          */import{E as h}from"./el-divider-BrE4ZIeE.js";import{a as k,E as _}from"./el-form-item-DCu0bDJP.js";import{E as x,a as V}from"./el-col-D1K5Gn4C.js";import{E as w}from"./el-switch-Cly3c4QB.js";import"./el-tooltip-l0sNRNKZ.js";import{E as j}from"./el-popper-Bv917HkU.js";import{a as y,E as U}from"./el-radio-group-DCPzcd32.js";import"./el-tag-syt7MiqL.js";import{E as N}from"./el-select-v2-DQG2z8db.js";import{E as I}from"./el-input-number-CqVFN3gb.js";import{E as M}from"./el-text-BkzwFLJI.js";import{r as T}from"./index-kuLHsiIe.js";import{b as A}from"./index-usU51_tD.js";import{c as P}from"./index-D3rW6bN_.js";import{a as E}from"./index-D3X1cvrx.js";const C=(e,a,t)=>T.post({url:"/api/project/data",data:{search:e,pageIndex:a,pageSize:t}}),L=e=>T.post({url:"/api/project/delete",data:{id:e}}),q={key:1},D=e({__name:"AddProject",props:{closeDialog:{type:Function},projectid:{},getProjectData:{type:Function},schedule:{type:Boolean}},setup(e){const{t:C}=g();let L=a({name:"",tag:"",logo:"",target:"",scheduledTasks:!0,subdomainScan:!0,subdomainConfig:[],urlScan:!0,sensitiveInfoScan:!0,pageMonitoring:"JS",crawlerScan:!0,vulScan:!1,vulList:[],hour:24,waybackurl:!0,portScan:!0,ports:"",dirScan:!1,node:[],allNode:!1,duplicates:!0});const D=e,z=t((()=>{const e={name:[{required:!0,message:C("project.msgProject"),trigger:"blur"}],tag:[{required:!0,message:C("project.msgProjectTag"),trigger:"blur"}],target:[{required:!0,message:C("project.msgProjectScope"),trigger:"blur"}],node:[{required:!1,message:C("task.nodeMsg"),trigger:"blur"}]};return L.scheduledTasks&&(e.node=[{required:!0,message:C("task.nodeMsg"),trigger:"blur"}]),e})),F=a([]),J=l(!1),R=l(),B=async e=>{J.value=!0,e&&(await e.validate((async(e,a)=>{if(e)if(""==D.projectid){200===(await(t=L.name,l=L.tag,o=L.target,n=L.logo,c=L.scheduledTasks,i=L.subdomainScan,s=L.subdomainConfig,d=L.urlScan,u=L.sensitiveInfoScan,r=L.pageMonitoring,p=L.crawlerScan,m=L.vulScan,f=L.vulList,g=L.hour,v=L.portScan,b=L.ports,S=L.dirScan,h=L.allNode,k=L.node,_=L.waybackurl,x=L.duplicates,T.post({url:"/api/project/add",data:{name:t,tag:l,target:o,logo:n,scheduledTasks:c,subdomainScan:i,subdomainConfig:s,urlScan:d,sensitiveInfoScan:u,pageMonitoring:r,crawlerScan:p,vulScan:m,vulList:f,hour:g,portScan:v,ports:b,dirScan:S,allNode:h,node:k,waybackurl:_,duplicates:x}}))).code&&D.closeDialog(),J.value=!1}else{const e=await((e,a,t,l,o,n,c,i,s,d,u,r,p,m,f,g,v,b,S,h,k,_)=>T.post({url:"/api/project/update",data:{id:e,name:a,tag:t,target:l,logo:o,scheduledTasks:n,subdomainScan:c,subdomainConfig:i,urlScan:s,sensitiveInfoScan:d,pageMonitoring:u,crawlerScan:r,vulScan:p,vulList:m,hour:f,portScan:g,ports:v,dirScan:b,allNode:S,node:h,waybackurl:k,duplicates:_}}))(D.projectid,L.name,L.tag,L.target,L.logo,L.scheduledTasks,L.subdomainScan,L.subdomainConfig,L.urlScan,L.sensitiveInfoScan,L.pageMonitoring,L.crawlerScan,L.vulScan,L.vulList,L.hour,L.portScan,L.ports,L.dirScan,L.allNode,L.node,L.waybackurl,L.duplicates);200===e.code&&D.closeDialog(),J.value=!1}else J.value=!1;var t,l,o,n,c,i,s,d,u,r,p,m,f,g,v,b,S,h,k,_,x})),D.getProjectData(0,0))};(async()=>{const e=await A();e.data.list.length>0&&(F.push({value:"All Poc",label:"All Poc"}),e.data.list.forEach((e=>{F.push({value:e.id,label:e.name})})))})();const H=l(!1);(async()=>{if(""!=D.projectid){H.value=!0;const a=await(e=D.projectid,T.post({url:"/api/project/content",data:{id:e}}));L.name=a.data.name,L.tag=a.data.tag,L.target=a.data.target,L.logo=a.data.logo,L.scheduledTasks=a.data.scheduledTasks,L.subdomainScan=a.data.subdomainScan,L.subdomainConfig=a.data.subdomainConfig,L.urlScan=a.data.urlScan,L.sensitiveInfoScan=a.data.sensitiveInfoScan,L.pageMonitoring=a.data.pageMonitoring,L.crawlerScan=a.data.crawlerScan,L.vulScan=a.data.vulScan,L.vulList=a.data.vulList,L.hour=a.data.hour,L.portScan=a.data.portScan,L.ports=a.data.ports,L.dirScan=a.data.dirScan,L.allNode=a.data.allNode,L.node=a.data.node}var e})();const G=a([]);(async()=>{const e=await P("",1,1e4);e.data.list.length>0&&e.data.list.forEach((e=>{G.push({value:e.id,label:e.name})}))})();const K=l(!1),Z=l(!1),$=a([]);(async()=>{const e=await E();e.data.list.length>0?(Z.value=!1,e.data.list.forEach((e=>{$.push({value:e,label:e})}))):(Z.value=!0,v.warning(C("node.onlineNodeMsg")))})();const O=e=>{K.value=!1,e?(L.allNode=!0,L.node=[],$.forEach((e=>L.node.push(e.value)))):(L.allNode=!1,L.node=[])};return(e,a)=>(o(),n(s(_),{model:s(L),"label-width":"120px",rules:z.value,"status-icon":"",ref_key:"ruleFormRef",ref:R,loading:H.value},{default:c((()=>[i(s(k),{label:s(C)("project.projectName"),prop:"name"},{default:c((()=>[i(s(d),{modelValue:s(L).name,"onUpdate:modelValue":a[0]||(a[0]=e=>s(L).name=e),placeholder:s(C)("project.msgProject")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),i(s(k),{label:"TAG",prop:"tag"},{default:c((()=>[i(s(d),{modelValue:s(L).tag,"onUpdate:modelValue":a[1]||(a[1]=e=>s(L).tag=e),placeholder:s(C)("project.msgProjectTag")},null,8,["modelValue","placeholder"])])),_:1}),i(s(k),{label:s(C)("project.projectScope"),prop:"target"},{default:c((()=>[i(s(d),{modelValue:s(L).target,"onUpdate:modelValue":a[2]||(a[2]=e=>s(L).target=e),placeholder:s(C)("project.msgProjectScope"),type:"textarea",autosize:{minRows:6,maxRows:15}},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),i(s(k),{label:"Logo",prop:"logo"},{default:c((()=>[i(s(d),{modelValue:s(L).logo,"onUpdate:modelValue":a[3]||(a[3]=e=>s(L).logo=e),placeholder:"http(s)://xxxxx.xx"},null,8,["modelValue"])])),_:1}),i(s(h),{"content-position":"center",style:{}},{default:c((()=>[u(r(s(C)("project.scheduledTasks")),1)])),_:1}),i(s(V),null,{default:c((()=>[i(s(x),{span:6},{default:c((()=>[i(s(k),{label:s(C)("project.scheduledTasks")},{default:c((()=>[i(s(j),{effect:"dark",content:s(C)("project.msgScheduledTasks"),placement:"top"},{default:c((()=>[i(s(w),{modelValue:s(L).scheduledTasks,"onUpdate:modelValue":a[4]||(a[4]=e=>s(L).scheduledTasks=e),"inline-prompt":"","active-text":s(C)("common.switchAction"),"inactive-text":s(C)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["content"])])),_:1},8,["label"])])),_:1}),s(L).scheduledTasks?(o(),n(s(x),{key:0,span:12},{default:c((()=>[i(s(k),{label:s(C)("project.cycle"),prop:"type"},{default:c((()=>[i(s(I),{modelValue:s(L).hour,"onUpdate:modelValue":a[5]||(a[5]=e=>s(L).hour=e),min:1,"controls-position":"right",size:"small"},null,8,["modelValue"]),i(s(M),{style:{position:"relative",left:"16px"}},{default:c((()=>[u("Hour")])),_:1})])),_:1},8,["label"])])),_:1})):p("",!0)])),_:1}),s(L).scheduledTasks?(o(),n(s(j),{key:0,content:s(C)("task.selectNodeMsg"),placement:"top"},{default:c((()=>[i(s(k),{label:s(C)("task.nodeSelect"),prop:"node"},{default:c((()=>[i(s(N),{modelValue:s(L).node,"onUpdate:modelValue":a[7]||(a[7]=e=>s(L).node=e),filterable:"",options:$,placeholder:"Please select node",style:{width:"80%"},multiple:"","tag-type":"success","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":7},{header:c((()=>[i(s(b),{modelValue:s(L).allNode,"onUpdate:modelValue":a[6]||(a[6]=e=>s(L).allNode=e),disabled:Z.value,indeterminate:K.value,onChange:O},{default:c((()=>[u(" All ")])),_:1},8,["modelValue","disabled","indeterminate"])])),_:1},8,["modelValue","options"])])),_:1},8,["label"])])),_:1},8,["content"])):p("",!0),s(L).scheduledTasks?(o(),m("div",q,[i(s(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:c((()=>[u(r(s(C)("subdomain.subdomainName")),1)])),_:1}),e.$props.schedule?p("",!0):(o(),n(s(V),{key:0},{default:c((()=>[i(s(x),{span:6},{default:c((()=>[i(s(j),{content:s(C)("task.duplicatesMsg"),placement:"top"},{default:c((()=>[i(s(k),{label:s(C)("task.duplicates")},{default:c((()=>[i(s(w),{modelValue:s(L).duplicates,"onUpdate:modelValue":a[8]||(a[8]=e=>s(L).duplicates=e),"inline-prompt":"","active-text":s(C)("common.true"),"inactive-text":s(C)("common.false")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1},8,["content"])])),_:1})])),_:1})),i(s(V),null,{default:c((()=>[i(s(x),{span:6},{default:c((()=>[i(s(k),{label:s(C)("task.subdomainScan")},{default:c((()=>[i(s(w),{modelValue:s(L).subdomainScan,"onUpdate:modelValue":a[9]||(a[9]=e=>s(L).subdomainScan=e),"inline-prompt":"","active-text":s(C)("common.switchAction"),"inactive-text":s(C)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),i(s(x),{span:12},{default:c((()=>[s(L).subdomainScan?(o(),n(s(k),{key:0,label:s(C)("task.config"),prop:"type"},{default:c((()=>[i(s(S),{modelValue:s(L).subdomainConfig,"onUpdate:modelValue":a[10]||(a[10]=e=>s(L).subdomainConfig=e)},{default:c((()=>[i(s(b),{label:"Subfinder",name:"subdomainConfig",checked:!0}),i(s(b),{label:"Ksubdomain",name:"subdomainConfig",checked:!0})])),_:1},8,["modelValue"])])),_:1},8,["label"])):p("",!0)])),_:1})])),_:1}),i(s(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:c((()=>[u(r(s(C)("task.portScan")),1)])),_:1}),i(s(V),null,{default:c((()=>[i(s(x),{span:6},{default:c((()=>[i(s(k),{label:s(C)("task.portScan")},{default:c((()=>[i(s(w),{modelValue:s(L).portScan,"onUpdate:modelValue":a[11]||(a[11]=e=>s(L).portScan=e),"inline-prompt":"","active-text":s(C)("common.switchAction"),"inactive-text":s(C)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),i(s(x),{span:12},{default:c((()=>[s(L).portScan?(o(),n(s(k),{key:0,label:s(C)("task.portSelect"),prop:"portScan"},{default:c((()=>[i(s(N),{modelValue:s(L).ports,"onUpdate:modelValue":a[12]||(a[12]=e=>s(L).ports=e),filterable:"",options:G,placeholder:"Please select port",style:{width:"80%"}},null,8,["modelValue","options"])])),_:1},8,["label"])):p("",!0)])),_:1})])),_:1}),i(s(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:c((()=>[u(r(s(C)("dirScan.dirScanName")),1)])),_:1}),i(s(k),{label:s(C)("dirScan.dirScanName")},{default:c((()=>[i(s(w),{modelValue:s(L).dirScan,"onUpdate:modelValue":a[13]||(a[13]=e=>s(L).dirScan=e),"inline-prompt":"","active-text":s(C)("common.switchAction"),"inactive-text":s(C)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"]),i(s(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:c((()=>[u(r(s(C)("crawler.crawlerName")),1)])),_:1}),i(s(V),null,{default:c((()=>[i(s(x),{span:6},{default:c((()=>[i(s(j),{effect:"dark",content:s(C)("task.msgUrl"),placement:"top"},{default:c((()=>[i(s(k),{label:s(C)("task.url")},{default:c((()=>[i(s(w),{modelValue:s(L).urlScan,"onUpdate:modelValue":a[14]||(a[14]=e=>s(L).urlScan=e),"inline-prompt":"","active-text":s(C)("common.switchAction"),"inactive-text":s(C)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1},8,["content"])])),_:1}),i(s(x),{span:6},{default:c((()=>[s(L).urlScan?(o(),n(s(k),{key:0,label:s(C)("task.sensitiveInfoScan"),prop:"type"},{default:c((()=>[i(s(w),{modelValue:s(L).sensitiveInfoScan,"onUpdate:modelValue":a[15]||(a[15]=e=>s(L).sensitiveInfoScan=e),"inline-prompt":"","active-text":s(C)("common.switchAction"),"inactive-text":s(C)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])):p("",!0)])),_:1}),i(s(x),{span:6},{default:c((()=>[i(s(j),{effect:"dark",content:s(C)("task.waybackUrlMsg"),placement:"top"},{default:c((()=>[s(L).urlScan?(o(),n(s(k),{key:0,label:"waybackurl",prop:"type"},{default:c((()=>[i(s(w),{modelValue:s(L).waybackurl,"onUpdate:modelValue":a[16]||(a[16]=e=>s(L).waybackurl=e),"inline-prompt":"","active-text":s(C)("common.switchAction"),"inactive-text":s(C)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1})):p("",!0)])),_:1},8,["content"])])),_:1}),i(s(x),{span:12,offset:6},{default:c((()=>[s(L).urlScan?(o(),n(s(k),{key:0,label:s(C)("task.pageMonitoring"),prop:"type"},{default:c((()=>[i(s(y),{modelValue:s(L).pageMonitoring,"onUpdate:modelValue":a[17]||(a[17]=e=>s(L).pageMonitoring=e)},{default:c((()=>[i(s(U),{label:"None",name:"pageMonitoring"}),i(s(j),{effect:"dark",content:s(C)("task.msgPageMonitoringAll"),placement:"top"},{default:c((()=>[i(s(U),{label:"All",name:"pageMonitoring",checked:!0})])),_:1},8,["content"]),i(s(j),{effect:"dark",content:s(C)("task.msgPageMonitoringJs"),placement:"top"},{default:c((()=>[i(s(U),{label:"JS",name:"pageMonitoring"})])),_:1},8,["content"])])),_:1},8,["modelValue"])])),_:1},8,["label"])):p("",!0)])),_:1})])),_:1}),i(s(k),{label:s(C)("crawler.crawlerName"),prop:"type"},{default:c((()=>[i(s(j),{effect:"dark",content:s(C)("task.msgCrawler"),placement:"top"},{default:c((()=>[i(s(w),{modelValue:s(L).crawlerScan,"onUpdate:modelValue":a[18]||(a[18]=e=>s(L).crawlerScan=e),"inline-prompt":"","active-text":s(C)("common.switchAction"),"inactive-text":s(C)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["content"])])),_:1},8,["label"]),i(s(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:c((()=>[u(r(s(C)("task.vulScan")),1)])),_:1}),i(s(V),null,{default:c((()=>[i(s(x),{span:6},{default:c((()=>[i(s(k),{label:s(C)("task.vulScan")},{default:c((()=>[i(s(w),{modelValue:s(L).vulScan,"onUpdate:modelValue":a[19]||(a[19]=e=>s(L).vulScan=e),"inline-prompt":"","active-text":s(C)("common.switchAction"),"inactive-text":s(C)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),i(s(x),{span:18},{default:c((()=>[s(L).vulScan?(o(),n(s(k),{key:0,label:s(C)("task.vulList"),prop:"type"},{default:c((()=>[i(s(N),{modelValue:s(L).vulList,"onUpdate:modelValue":a[20]||(a[20]=e=>s(L).vulList=e),filterable:"",options:F,placeholder:"Please select vul",style:{width:"80%"},multiple:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":3},null,8,["modelValue","options"])])),_:1},8,["label"])):p("",!0)])),_:1})])),_:1})])):p("",!0),i(s(h)),i(s(V),null,{default:c((()=>[i(s(x),{span:2,offset:8},{default:c((()=>[i(s(k),null,{default:c((()=>[i(s(f),{type:"primary",onClick:a[21]||(a[21]=e=>B(R.value)),loading:J.value},{default:c((()=>[u(r(s(C)("task.save")),1)])),_:1},8,["loading"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules","loading"]))}});export{D as _,L as d,C as g};
