import{d as e,s as a,a3 as t,r as l,o,i as n,w as c,e as d,a as s,J as i,y as u,t as r,j as p,c as m,z as f,l as g,N as v}from"./index-KWTKF9N9.js";import{E as b,a as S}from"./el-checkbox-U1iRgEY7.js";/* empty css                          */import{E as h}from"./el-divider-685xvbVJ.js";import{a as k,E as _}from"./el-form-item-i8ZQhvu8.js";import{E as w,a as V}from"./el-col-t_F-vIr3.js";import{E as x}from"./el-switch-tqt83myp.js";import"./el-tooltip-w40geAFS.js";import{E as y}from"./el-popper-pnFa2Ecw.js";import{a as j,E as M}from"./el-radio-group-MC2AFabc.js";import"./el-tag-MzjVikBY.js";import{E as N}from"./el-select-v2-0dTEd5GK.js";import{E as U}from"./el-input-number-Rb_QWPs-.js";import{E as I}from"./el-text-bFj0OZ8x.js";import{r as T}from"./index-XFn6QxJu.js";import{b as P}from"./index-kUGlyjnD.js";import{c as A}from"./index-6VLehrwJ.js";import{a as C}from"./index-Dm_8ErkC.js";const E=(e,a,t)=>T.post({url:"/api/project/data",data:{search:e,pageIndex:a,pageSize:t}}),L=e=>T.post({url:"/api/project/delete",data:{id:e}}),D={key:1},q=e({__name:"AddProject",props:{closeDialog:{type:Function},projectid:{},getProjectData:{type:Function},schedule:{type:Boolean}},setup(e){const{t:E}=g();let L=a({name:"",tag:"",logo:"",target:"",scheduledTasks:!0,subdomainScan:!0,subdomainConfig:[],urlScan:!0,sensitiveInfoScan:!0,pageMonitoring:"JS",crawlerScan:!0,vulScan:!1,vulList:[],hour:24,waybackurl:!0,portScan:!0,ports:"",dirScan:!1,node:[],allNode:!1,duplicates:""});const q=e,z=t((()=>{const e={name:[{required:!0,message:E("project.msgProject"),trigger:"blur"}],tag:[{required:!0,message:E("project.msgProjectTag"),trigger:"blur"}],target:[{required:!0,message:E("project.msgProjectScope"),trigger:"blur"}],node:[{required:!1,message:E("task.nodeMsg"),trigger:"blur"}]};return L.scheduledTasks&&(e.node=[{required:!0,message:E("task.nodeMsg"),trigger:"blur"}]),e})),J=a([]),F=l(!1),R=l(),K=async e=>{F.value=!0,e&&(await e.validate((async(e,a)=>{if(e)if(""==q.projectid){200===(await(t=L.name,l=L.tag,o=L.target,n=L.logo,c=L.scheduledTasks,d=L.subdomainScan,s=L.subdomainConfig,i=L.urlScan,u=L.sensitiveInfoScan,r=L.pageMonitoring,p=L.crawlerScan,m=L.vulScan,f=L.vulList,g=L.hour,v=L.portScan,b=L.ports,S=L.dirScan,h=L.allNode,k=L.node,_=L.waybackurl,w=L.duplicates,T.post({url:"/api/project/add",data:{name:t,tag:l,target:o,logo:n,scheduledTasks:c,subdomainScan:d,subdomainConfig:s,urlScan:i,sensitiveInfoScan:u,pageMonitoring:r,crawlerScan:p,vulScan:m,vulList:f,hour:g,portScan:v,ports:b,dirScan:S,allNode:h,node:k,waybackurl:_,duplicates:w}}))).code&&q.closeDialog(),F.value=!1}else{const e=await((e,a,t,l,o,n,c,d,s,i,u,r,p,m,f,g,v,b,S,h,k,_)=>T.post({url:"/api/project/update",data:{id:e,name:a,tag:t,target:l,logo:o,scheduledTasks:n,subdomainScan:c,subdomainConfig:d,urlScan:s,sensitiveInfoScan:i,pageMonitoring:u,crawlerScan:r,vulScan:p,vulList:m,hour:f,portScan:g,ports:v,dirScan:b,allNode:S,node:h,waybackurl:k,duplicates:_}}))(q.projectid,L.name,L.tag,L.target,L.logo,L.scheduledTasks,L.subdomainScan,L.subdomainConfig,L.urlScan,L.sensitiveInfoScan,L.pageMonitoring,L.crawlerScan,L.vulScan,L.vulList,L.hour,L.portScan,L.ports,L.dirScan,L.allNode,L.node,L.waybackurl,L.duplicates);200===e.code&&q.closeDialog(),F.value=!1}else F.value=!1;var t,l,o,n,c,d,s,i,u,r,p,m,f,g,v,b,S,h,k,_,w})),q.getProjectData(0,0))};(async()=>{const e=await P();e.data.list.length>0&&(J.push({value:"All Poc",label:"All Poc"}),e.data.list.forEach((e=>{J.push({value:e.id,label:e.name})})))})();const B=l(!1);(async()=>{if(""!=q.projectid){B.value=!0;const a=await(e=q.projectid,T.post({url:"/api/project/content",data:{id:e}}));L.name=a.data.name,L.tag=a.data.tag,L.target=a.data.target,L.logo=a.data.logo,L.scheduledTasks=a.data.scheduledTasks,L.subdomainScan=a.data.subdomainScan,L.subdomainConfig=a.data.subdomainConfig,L.urlScan=a.data.urlScan,L.sensitiveInfoScan=a.data.sensitiveInfoScan,L.pageMonitoring=a.data.pageMonitoring,L.crawlerScan=a.data.crawlerScan,L.vulScan=a.data.vulScan,L.vulList=a.data.vulList,L.hour=a.data.hour,L.portScan=a.data.portScan,L.ports=a.data.ports,L.dirScan=a.data.dirScan,L.allNode=a.data.allNode,L.node=a.data.node,L.duplicates=a.data.duplicates,B.value=!1}var e})();const G=a([]);(async()=>{const e=await A("",1,1e4);e.data.list.length>0&&e.data.list.forEach((e=>{G.push({value:e.id,label:e.name})}))})();const H=l(!1),O=l(!1),Q=a([]);(async()=>{const e=await C();e.data.list.length>0?(O.value=!1,e.data.list.forEach((e=>{Q.push({value:e,label:e})}))):(O.value=!0,v.warning(E("node.onlineNodeMsg")))})();const W=e=>{H.value=!1,e?(L.allNode=!0,L.node=[],Q.forEach((e=>L.node.push(e.value)))):(L.allNode=!1,L.node=[])};return(e,a)=>(o(),n(s(_),{model:s(L),"label-width":"auto",rules:z.value,"status-icon":"",ref_key:"ruleFormRef",ref:R,loading:B.value},{default:c((()=>[d(s(k),{label:s(E)("project.projectName"),prop:"name"},{default:c((()=>[d(s(i),{modelValue:s(L).name,"onUpdate:modelValue":a[0]||(a[0]=e=>s(L).name=e),placeholder:s(E)("project.msgProject")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),d(s(k),{label:"TAG",prop:"tag"},{default:c((()=>[d(s(i),{modelValue:s(L).tag,"onUpdate:modelValue":a[1]||(a[1]=e=>s(L).tag=e),placeholder:s(E)("project.msgProjectTag")},null,8,["modelValue","placeholder"])])),_:1}),d(s(k),{label:s(E)("project.projectScope"),prop:"target"},{default:c((()=>[d(s(i),{modelValue:s(L).target,"onUpdate:modelValue":a[2]||(a[2]=e=>s(L).target=e),placeholder:s(E)("project.msgProjectScope"),type:"textarea",autosize:{minRows:6,maxRows:15}},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),d(s(k),{label:"Logo",prop:"logo"},{default:c((()=>[d(s(i),{modelValue:s(L).logo,"onUpdate:modelValue":a[3]||(a[3]=e=>s(L).logo=e),placeholder:"http(s)://xxxxx.xx"},null,8,["modelValue"])])),_:1}),d(s(h),{"content-position":"center",style:{}},{default:c((()=>[u(r(s(E)("project.scheduledTasks")),1)])),_:1}),d(s(V),null,{default:c((()=>[d(s(w),{span:6},{default:c((()=>[d(s(k),{label:s(E)("project.scheduledTasks")},{default:c((()=>[d(s(y),{effect:"dark",content:s(E)("project.msgScheduledTasks"),placement:"top"},{default:c((()=>[d(s(x),{modelValue:s(L).scheduledTasks,"onUpdate:modelValue":a[4]||(a[4]=e=>s(L).scheduledTasks=e),"inline-prompt":"","active-text":s(E)("common.switchAction"),"inactive-text":s(E)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["content"])])),_:1},8,["label"])])),_:1}),s(L).scheduledTasks?(o(),n(s(w),{key:0,span:12},{default:c((()=>[d(s(k),{label:s(E)("project.cycle"),prop:"type"},{default:c((()=>[d(s(U),{modelValue:s(L).hour,"onUpdate:modelValue":a[5]||(a[5]=e=>s(L).hour=e),min:1,"controls-position":"right",size:"small"},null,8,["modelValue"]),d(s(I),{style:{position:"relative",left:"16px"}},{default:c((()=>[u("Hour")])),_:1})])),_:1},8,["label"])])),_:1})):p("",!0)])),_:1}),s(L).scheduledTasks?(o(),n(s(y),{key:0,content:s(E)("task.selectNodeMsg"),placement:"top"},{default:c((()=>[d(s(k),{label:s(E)("task.nodeSelect"),prop:"node"},{default:c((()=>[d(s(N),{modelValue:s(L).node,"onUpdate:modelValue":a[7]||(a[7]=e=>s(L).node=e),filterable:"",options:Q,placeholder:"Please select node",style:{width:"80%"},multiple:"","tag-type":"success","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":7},{header:c((()=>[d(s(b),{modelValue:s(L).allNode,"onUpdate:modelValue":a[6]||(a[6]=e=>s(L).allNode=e),disabled:O.value,indeterminate:H.value,onChange:W},{default:c((()=>[u(" All ")])),_:1},8,["modelValue","disabled","indeterminate"])])),_:1},8,["modelValue","options"])])),_:1},8,["label"])])),_:1},8,["content"])):p("",!0),s(L).scheduledTasks?(o(),m("div",D,[d(s(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:c((()=>[u(r(s(E)("task.duplicates")),1)])),_:1}),d(s(V),null,{default:c((()=>[d(s(w),{span:24},{default:c((()=>[d(s(k),{label:s(E)("task.duplicates"),prop:"type"},{default:c((()=>[d(s(j),{modelValue:s(L).duplicates,"onUpdate:modelValue":a[8]||(a[8]=e=>s(L).duplicates=e)},{default:c((()=>[d(s(M),{label:"None",name:"duplicates",checked:!0,value:"None"}),d(s(y),{effect:"dark",content:s(E)("task.duplicatesMsg"),placement:"top"},{default:c((()=>[d(s(M),{label:s(E)("task.duplicatesSubdomain"),name:"duplicates",value:"subdomain"},null,8,["label"])])),_:1},8,["content"]),d(s(y),{effect:"dark",content:s(E)("task.duplicatesPortMsg"),placement:"top"},{default:c((()=>[d(s(M),{label:s(E)("task.duplicatesPort"),name:"duplicates",value:"port"},null,8,["label"])])),_:1},8,["content"])])),_:1},8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1}),d(s(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:c((()=>[u(r(s(E)("subdomain.subdomainName")),1)])),_:1}),d(s(V),null,{default:c((()=>[d(s(w),{span:6},{default:c((()=>[d(s(k),{label:s(E)("task.subdomainScan")},{default:c((()=>[d(s(x),{modelValue:s(L).subdomainScan,"onUpdate:modelValue":a[9]||(a[9]=e=>s(L).subdomainScan=e),"inline-prompt":"","active-text":s(E)("common.switchAction"),"inactive-text":s(E)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),d(s(w),{span:12},{default:c((()=>[s(L).subdomainScan?(o(),n(s(k),{key:0,label:s(E)("task.config"),prop:"type"},{default:c((()=>[d(s(S),{modelValue:s(L).subdomainConfig,"onUpdate:modelValue":a[10]||(a[10]=e=>s(L).subdomainConfig=e)},{default:c((()=>[d(s(b),{label:"Subfinder",name:"subdomainConfig",checked:!0}),d(s(b),{label:"Ksubdomain",name:"subdomainConfig",checked:!0})])),_:1},8,["modelValue"])])),_:1},8,["label"])):p("",!0)])),_:1})])),_:1}),d(s(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:c((()=>[u(r(s(E)("task.portScan")),1)])),_:1}),d(s(V),null,{default:c((()=>[d(s(w),{span:6},{default:c((()=>[d(s(k),{label:s(E)("task.portScan")},{default:c((()=>[d(s(x),{modelValue:s(L).portScan,"onUpdate:modelValue":a[11]||(a[11]=e=>s(L).portScan=e),"inline-prompt":"","active-text":s(E)("common.switchAction"),"inactive-text":s(E)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),d(s(w),{span:12},{default:c((()=>[s(L).portScan?(o(),n(s(k),{key:0,label:s(E)("task.portSelect"),prop:"portScan"},{default:c((()=>[d(s(N),{modelValue:s(L).ports,"onUpdate:modelValue":a[12]||(a[12]=e=>s(L).ports=e),filterable:"",options:G,placeholder:"Please select port",style:{width:"80%"}},null,8,["modelValue","options"])])),_:1},8,["label"])):p("",!0)])),_:1})])),_:1}),d(s(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:c((()=>[u(r(s(E)("dirScan.dirScanName")),1)])),_:1}),d(s(k),{label:s(E)("dirScan.dirScanName")},{default:c((()=>[d(s(x),{modelValue:s(L).dirScan,"onUpdate:modelValue":a[13]||(a[13]=e=>s(L).dirScan=e),"inline-prompt":"","active-text":s(E)("common.switchAction"),"inactive-text":s(E)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"]),d(s(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:c((()=>[u(r(s(E)("crawler.crawlerName")),1)])),_:1}),d(s(V),null,{default:c((()=>[d(s(w),{span:6},{default:c((()=>[d(s(y),{effect:"dark",content:s(E)("task.msgUrl"),placement:"top"},{default:c((()=>[d(s(k),{label:s(E)("task.url")},{default:c((()=>[d(s(x),{modelValue:s(L).urlScan,"onUpdate:modelValue":a[14]||(a[14]=e=>s(L).urlScan=e),"inline-prompt":"","active-text":s(E)("common.switchAction"),"inactive-text":s(E)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1},8,["content"])])),_:1}),d(s(w),{span:6},{default:c((()=>[s(L).urlScan?(o(),n(s(k),{key:0,label:s(E)("task.sensitiveInfoScan"),prop:"type"},{default:c((()=>[d(s(x),{modelValue:s(L).sensitiveInfoScan,"onUpdate:modelValue":a[15]||(a[15]=e=>s(L).sensitiveInfoScan=e),"inline-prompt":"","active-text":s(E)("common.switchAction"),"inactive-text":s(E)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])):p("",!0)])),_:1}),d(s(w),{span:6},{default:c((()=>[d(s(y),{effect:"dark",content:s(E)("task.waybackUrlMsg"),placement:"top"},{default:c((()=>[s(L).urlScan?(o(),n(s(k),{key:0,label:"waybackurl",prop:"type"},{default:c((()=>[d(s(x),{modelValue:s(L).waybackurl,"onUpdate:modelValue":a[16]||(a[16]=e=>s(L).waybackurl=e),"inline-prompt":"","active-text":s(E)("common.switchAction"),"inactive-text":s(E)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1})):p("",!0)])),_:1},8,["content"])])),_:1}),d(s(w),{span:12,offset:6},{default:c((()=>[s(L).urlScan?(o(),n(s(k),{key:0,label:s(E)("task.pageMonitoring"),prop:"type"},{default:c((()=>[d(s(j),{modelValue:s(L).pageMonitoring,"onUpdate:modelValue":a[17]||(a[17]=e=>s(L).pageMonitoring=e)},{default:c((()=>[d(s(M),{label:"None",name:"pageMonitoring"}),d(s(y),{effect:"dark",content:s(E)("task.msgPageMonitoringAll"),placement:"top"},{default:c((()=>[d(s(M),{label:"All",name:"pageMonitoring",checked:!0})])),_:1},8,["content"]),d(s(y),{effect:"dark",content:s(E)("task.msgPageMonitoringJs"),placement:"top"},{default:c((()=>[d(s(M),{label:"JS",name:"pageMonitoring"})])),_:1},8,["content"])])),_:1},8,["modelValue"])])),_:1},8,["label"])):p("",!0)])),_:1})])),_:1}),d(s(k),{label:s(E)("crawler.crawlerName"),prop:"type"},{default:c((()=>[d(s(y),{effect:"dark",content:s(E)("task.msgCrawler"),placement:"top"},{default:c((()=>[d(s(x),{modelValue:s(L).crawlerScan,"onUpdate:modelValue":a[18]||(a[18]=e=>s(L).crawlerScan=e),"inline-prompt":"","active-text":s(E)("common.switchAction"),"inactive-text":s(E)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["content"])])),_:1},8,["label"]),d(s(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:c((()=>[u(r(s(E)("task.vulScan")),1)])),_:1}),d(s(V),null,{default:c((()=>[d(s(w),{span:6},{default:c((()=>[d(s(k),{label:s(E)("task.vulScan")},{default:c((()=>[d(s(x),{modelValue:s(L).vulScan,"onUpdate:modelValue":a[19]||(a[19]=e=>s(L).vulScan=e),"inline-prompt":"","active-text":s(E)("common.switchAction"),"inactive-text":s(E)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),d(s(w),{span:18},{default:c((()=>[s(L).vulScan?(o(),n(s(k),{key:0,label:s(E)("task.vulList"),prop:"type"},{default:c((()=>[d(s(N),{modelValue:s(L).vulList,"onUpdate:modelValue":a[20]||(a[20]=e=>s(L).vulList=e),filterable:"",options:J,placeholder:"Please select vul",style:{width:"80%"},multiple:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":3},null,8,["modelValue","options"])])),_:1},8,["label"])):p("",!0)])),_:1})])),_:1})])):p("",!0),d(s(h)),d(s(V),null,{default:c((()=>[d(s(w),{span:2,offset:12},{default:c((()=>[d(s(k),null,{default:c((()=>[d(s(f),{type:"primary",onClick:a[21]||(a[21]=e=>K(R.value)),loading:F.value},{default:c((()=>[u(r(s(E)("task.save")),1)])),_:1},8,["loading"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules","loading"]))}});export{q as _,L as d,E as g};
