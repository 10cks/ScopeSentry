import{d as e,bw as a,r as l,N as t,Y as o,o as n,i as u,w as s,e as i,a as c,Z as d,H as r,j as p,t as m,I as v,l as f,a2 as b}from"./index-RTeQX4Z1.js";import{E as g,a as k}from"./el-checkbox-bH4fVny5.js";/* empty css                          */import{E as h}from"./el-divider-C9tmp1am.js";import{a as _,E as V}from"./el-form-item-Bth-RQFo.js";import{E as w,a as S}from"./el-col-Clk25fNT.js";import{E as x}from"./el-switch-CXN3V_sb.js";import"./el-tooltip-l0sNRNKZ.js";import{E as y}from"./el-popper-BiF-N6C2.js";import{a as j,E as N}from"./el-radio-group-C3cxfPRm.js";import"./el-tag-DQ-f6KyF.js";import{E as U}from"./el-select-v2-gvYMzuV8.js";import{E as M}from"./el-input-number-BZ3WqMAD.js";import{E as A}from"./el-text-CpyCtW8d.js";import{a as I}from"./index-GlyP9fAr.js";import{b as T}from"./index-wW-hJ0Fn.js";import{c as E,e as P}from"./index-Dm4zoanK.js";import{c as C}from"./index-B7eLyWxy.js";const L=e({__name:"AddTask",props:{closeDialog:{type:Function},getList:{type:Function},vTaskForm:{},create:{type:Boolean},schedule:{type:Boolean},taskid:{}},setup(e){const{t:L}=f(),F=e,{vTaskForm:q}=a(F),D=l({...q.value}),B=t({name:[{required:!0,message:L("task.msgTaskName"),trigger:"blur"}],target:[{required:!0,message:L("task.msgTarget"),trigger:"blur"}],node:[{required:!0,message:L("task.nodeMsg"),trigger:"blur"}]}),H=l(!1),J=l(),z=t([]),K=t([]),Q=t([]);o((()=>{(async()=>{const e=await I();e.data.list.length>0?(Y.value=!1,e.data.list.forEach((e=>{z.push({value:e,label:e})}))):(Y.value=!0,b.warning(L("node.onlineNodeMsg")))})(),(async()=>{const e=await T();e.data.list.length>0&&(Q.push({value:"All Poc",label:"All Poc"}),e.data.list.forEach((e=>{Q.push({value:e.id,label:e.name})})))})(),(async()=>{const e=await C("",1,1e4);e.data.list.length>0&&e.data.list.forEach((e=>{K.push({value:e.id,label:e.name})}))})()}));const R=l(!1),Y=l(!1),Z=e=>{R.value=!1,e?(D.value.allNode=!0,D.value.node=[],z.forEach((e=>D.value.node.push(e.value)))):(D.value.allNode=!1,D.value.node=[])};return(e,a)=>(n(),u(c(V),{model:D.value,"label-width":"auto",rules:B,"status-icon":"",ref_key:"ruleFormRef",ref:J,disabled:!e.create},{default:s((()=>[i(c(_),{label:c(L)("task.taskName"),prop:"name"},{default:s((()=>[i(c(d),{modelValue:D.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>D.value.name=e),placeholder:c(L)("task.msgTaskName")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),i(c(_),{label:c(L)("task.taskTarget"),prop:"target"},{default:s((()=>[i(c(d),{modelValue:D.value.target,"onUpdate:modelValue":a[1]||(a[1]=e=>D.value.target=e),placeholder:c(L)("task.msgTarget"),type:"textarea",rows:"10"},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),i(c(y),{content:c(L)("task.selectNodeMsg"),placement:"top"},{default:s((()=>[i(c(_),{label:c(L)("task.nodeSelect"),prop:"node"},{default:s((()=>[i(c(U),{modelValue:D.value.node,"onUpdate:modelValue":a[3]||(a[3]=e=>D.value.node=e),filterable:"",options:z,placeholder:"Please select node",style:{width:"80%"},multiple:"","tag-type":"success","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":7},{header:s((()=>[i(c(g),{modelValue:D.value.allNode,"onUpdate:modelValue":a[2]||(a[2]=e=>D.value.allNode=e),disabled:Y.value,indeterminate:R.value,onChange:Z},{default:s((()=>[r(" All ")])),_:1},8,["modelValue","disabled","indeterminate"])])),_:1},8,["modelValue","options"])])),_:1},8,["label"])])),_:1},8,["content"]),i(c(S),null,{default:s((()=>[i(c(w),{span:12},{default:s((()=>[i(c(_),{label:c(L)("project.scheduledTasks")},{default:s((()=>[i(c(y),{effect:"dark",content:c(L)("project.msgScheduledTasks"),placement:"top"},{default:s((()=>[i(c(x),{modelValue:D.value.scheduledTasks,"onUpdate:modelValue":a[4]||(a[4]=e=>D.value.scheduledTasks=e),"inline-prompt":"","active-text":c(L)("common.switchAction"),"inactive-text":c(L)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["content"])])),_:1},8,["label"])])),_:1}),D.value.scheduledTasks?(n(),u(c(w),{key:0,span:12},{default:s((()=>[i(c(_),{label:c(L)("project.cycle"),prop:"type"},{default:s((()=>[i(c(M),{modelValue:D.value.hour,"onUpdate:modelValue":a[5]||(a[5]=e=>D.value.hour=e),min:1,"controls-position":"right",size:"small"},null,8,["modelValue"]),i(c(A),{style:{position:"relative",left:"16px"}},{default:s((()=>[r("Hour")])),_:1})])),_:1},8,["label"])])),_:1})):p("",!0)])),_:1}),i(c(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:s((()=>[r(m(c(L)("task.duplicates")),1)])),_:1}),i(c(S),null,{default:s((()=>[i(c(w),{span:24},{default:s((()=>[i(c(_),{label:c(L)("task.duplicates"),prop:"type"},{default:s((()=>[i(c(j),{modelValue:D.value.duplicates,"onUpdate:modelValue":a[6]||(a[6]=e=>D.value.duplicates=e)},{default:s((()=>[i(c(N),{label:"None",name:"duplicates",checked:!0,value:"None"}),i(c(y),{effect:"dark",content:c(L)("task.duplicatesMsg"),placement:"top"},{default:s((()=>[i(c(N),{label:c(L)("task.duplicatesSubdomain"),name:"duplicates",value:"subdomain"},null,8,["label"])])),_:1},8,["content"]),i(c(y),{effect:"dark",content:c(L)("task.duplicatesPortMsg"),placement:"top"},{default:s((()=>[i(c(N),{label:c(L)("task.duplicatesPort"),name:"duplicates",value:"port"},null,8,["label"])])),_:1},8,["content"])])),_:1},8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1}),i(c(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:s((()=>[r(m(c(L)("subdomain.subdomainName")),1)])),_:1}),i(c(S),null,{default:s((()=>[i(c(w),{span:6},{default:s((()=>[i(c(_),{label:c(L)("task.subdomainScan")},{default:s((()=>[i(c(x),{modelValue:D.value.subdomainScan,"onUpdate:modelValue":a[7]||(a[7]=e=>D.value.subdomainScan=e),"inline-prompt":"","active-text":c(L)("common.switchAction"),"inactive-text":c(L)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),i(c(w),{span:12},{default:s((()=>[D.value.subdomainScan?(n(),u(c(_),{key:0,label:c(L)("task.config"),prop:"type"},{default:s((()=>[i(c(k),{modelValue:D.value.subdomainConfig,"onUpdate:modelValue":a[8]||(a[8]=e=>D.value.subdomainConfig=e)},{default:s((()=>[i(c(g),{label:"Subfinder",name:"subdomainConfig",checked:!0}),i(c(g),{label:"Ksubdomain",name:"subdomainConfig",checked:!0})])),_:1},8,["modelValue"])])),_:1},8,["label"])):p("",!0)])),_:1})])),_:1}),i(c(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:s((()=>[r(m(c(L)("task.portScan")),1)])),_:1}),i(c(S),null,{default:s((()=>[i(c(w),{span:6},{default:s((()=>[i(c(_),{label:c(L)("task.portScan")},{default:s((()=>[i(c(x),{modelValue:D.value.portScan,"onUpdate:modelValue":a[9]||(a[9]=e=>D.value.portScan=e),"inline-prompt":"","active-text":c(L)("common.switchAction"),"inactive-text":c(L)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),i(c(w),{span:12},{default:s((()=>[D.value.portScan?(n(),u(c(_),{key:0,label:c(L)("task.portSelect"),prop:"portScan"},{default:s((()=>[i(c(U),{modelValue:D.value.ports,"onUpdate:modelValue":a[10]||(a[10]=e=>D.value.ports=e),filterable:"",options:K,placeholder:"Please select port",style:{width:"80%"}},null,8,["modelValue","options"])])),_:1},8,["label"])):p("",!0)])),_:1})])),_:1}),i(c(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:s((()=>[r(m(c(L)("dirScan.dirScanName")),1)])),_:1}),i(c(_),{label:c(L)("dirScan.dirScanName")},{default:s((()=>[i(c(x),{modelValue:D.value.dirScan,"onUpdate:modelValue":a[11]||(a[11]=e=>D.value.dirScan=e),"inline-prompt":"","active-text":c(L)("common.switchAction"),"inactive-text":c(L)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"]),i(c(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:s((()=>[r(m(c(L)("crawler.crawlerName")),1)])),_:1}),i(c(S),null,{default:s((()=>[i(c(w),{span:6},{default:s((()=>[i(c(y),{effect:"dark",content:c(L)("task.msgUrl"),placement:"top"},{default:s((()=>[i(c(_),{label:c(L)("task.url")},{default:s((()=>[i(c(x),{modelValue:D.value.urlScan,"onUpdate:modelValue":a[12]||(a[12]=e=>D.value.urlScan=e),"inline-prompt":"","active-text":c(L)("common.switchAction"),"inactive-text":c(L)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1},8,["content"])])),_:1}),i(c(w),{span:6},{default:s((()=>[D.value.urlScan?(n(),u(c(_),{key:0,label:c(L)("task.sensitiveInfoScan"),prop:"type"},{default:s((()=>[i(c(x),{modelValue:D.value.sensitiveInfoScan,"onUpdate:modelValue":a[13]||(a[13]=e=>D.value.sensitiveInfoScan=e),"inline-prompt":"","active-text":c(L)("common.switchAction"),"inactive-text":c(L)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])):p("",!0)])),_:1}),i(c(w),{span:6},{default:s((()=>[i(c(y),{effect:"dark",content:c(L)("task.waybackUrlMsg"),placement:"top"},{default:s((()=>[D.value.urlScan?(n(),u(c(_),{key:0,label:"waybackurl",prop:"type"},{default:s((()=>[i(c(x),{modelValue:D.value.waybackurl,"onUpdate:modelValue":a[14]||(a[14]=e=>D.value.waybackurl=e),"inline-prompt":"","active-text":c(L)("common.switchAction"),"inactive-text":c(L)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1})):p("",!0)])),_:1},8,["content"])])),_:1}),i(c(w),{span:12,offset:6},{default:s((()=>[D.value.urlScan?(n(),u(c(_),{key:0,label:c(L)("task.pageMonitoring"),prop:"type"},{default:s((()=>[i(c(j),{modelValue:D.value.pageMonitoring,"onUpdate:modelValue":a[15]||(a[15]=e=>D.value.pageMonitoring=e)},{default:s((()=>[i(c(N),{label:"None",name:"pageMonitoring"}),i(c(y),{effect:"dark",content:c(L)("task.msgPageMonitoringAll"),placement:"top"},{default:s((()=>[i(c(N),{label:"All",name:"pageMonitoring",checked:!0})])),_:1},8,["content"]),i(c(y),{effect:"dark",content:c(L)("task.msgPageMonitoringJs"),placement:"top"},{default:s((()=>[i(c(N),{label:"JS",name:"pageMonitoring"})])),_:1},8,["content"])])),_:1},8,["modelValue"])])),_:1},8,["label"])):p("",!0)])),_:1})])),_:1}),i(c(_),{label:c(L)("crawler.crawlerName"),prop:"type"},{default:s((()=>[i(c(y),{effect:"dark",content:c(L)("task.msgCrawler"),placement:"top"},{default:s((()=>[i(c(x),{modelValue:D.value.crawlerScan,"onUpdate:modelValue":a[16]||(a[16]=e=>D.value.crawlerScan=e),"inline-prompt":"","active-text":c(L)("common.switchAction"),"inactive-text":c(L)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["content"])])),_:1},8,["label"]),i(c(h),{"content-position":"center",style:{width:"60%",left:"20%"}},{default:s((()=>[r(m(c(L)("task.vulScan")),1)])),_:1}),i(c(S),null,{default:s((()=>[i(c(w),{span:6},{default:s((()=>[i(c(_),{label:c(L)("task.vulScan")},{default:s((()=>[i(c(x),{modelValue:D.value.vulScan,"onUpdate:modelValue":a[17]||(a[17]=e=>D.value.vulScan=e),"inline-prompt":"","active-text":c(L)("common.switchAction"),"inactive-text":c(L)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),i(c(w),{span:18},{default:s((()=>[D.value.vulScan?(n(),u(c(_),{key:0,label:c(L)("task.vulList"),prop:"type"},{default:s((()=>[i(c(U),{modelValue:D.value.vulList,"onUpdate:modelValue":a[18]||(a[18]=e=>D.value.vulList=e),filterable:"",options:Q,placeholder:"Please select vul",style:{width:"80%"},multiple:"","collapse-tags":"","collapse-tags-tooltip":"","tag-type":"info","max-collapse-tags":3},null,8,["modelValue","options"])])),_:1},8,["label"])):p("",!0)])),_:1})])),_:1}),i(c(h)),i(c(S),null,{default:s((()=>[i(c(w),{span:2,offset:10},{default:s((()=>[i(c(_),null,{default:s((()=>[i(c(v),{type:"primary",onClick:a[19]||(a[19]=e=>(async e=>{H.value=!0,e&&await e.validate((async(e,a)=>{D.value.allNode||(D.value.allNode=!1),e?(""===F.taskid?200===(await E(D.value.name,D.value.target,D.value.node,D.value.allNode,D.value.subdomainScan,D.value.subdomainConfig,D.value.urlScan,D.value.duplicates,D.value.sensitiveInfoScan,D.value.pageMonitoring,D.value.crawlerScan,D.value.vulScan,D.value.vulList,D.value.portScan,D.value.ports,D.value.dirScan,D.value.waybackurl,D.value.scheduledTasks,D.value.hour)).code&&(F.getList(),F.closeDialog()):200===(await P(F.taskid,D.value.name,D.value.target,D.value.node,D.value.allNode,D.value.subdomainScan,D.value.subdomainConfig,D.value.urlScan,D.value.duplicates,D.value.sensitiveInfoScan,D.value.pageMonitoring,D.value.crawlerScan,D.value.vulScan,D.value.vulList,D.value.portScan,D.value.ports,D.value.dirScan,D.value.waybackurl,D.value.scheduledTasks,D.value.hour)).code&&(F.getList(),F.closeDialog()),H.value=!1):H.value=!1}))})(J.value)),loading:H.value},{default:s((()=>[r(m(c(L)("task.save")),1)])),_:1},8,["loading"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules","disabled"]))}});export{L as _};
