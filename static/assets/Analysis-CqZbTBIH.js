import{P as e,g as t,U as a}from"./PanelGroup-CaVSDe8J.js";import{s,v as o,x as l,y as r,d as n,z as i,A as p,r as d,B as m,C as c,o as u,i as f,w as v,f as y,n as g,a as h,D as _,F as b,G as x,j as k,H as j,t as w,e as T,I as C,J as B,K as N,L as S,M as A,N as E,O as U,P as I,c as M,Q as F,l as P,_ as $}from"./index-rxu9Faad.js";import{E as z,a as R}from"./el-col-BKZxb-_G.js";import{E as G}from"./el-card-C0XrHsE5.js";import{E as J}from"./el-progress-7oah6g2A.js";import{E as O}from"./el-text-BLRhP_03.js";import"./el-tooltip-l0sNRNKZ.js";import{u as D,E as H}from"./el-popper-BJkW0SkV.js";/* empty css                   */import{_ as K}from"./Table.vue_vue_type_script_lang-COxZJx7A.js";import{E as Q}from"./el-tag-DFTmA9-y.js";import{g as q}from"./index-BaLibEYg.js";import{g as L}from"./index-BZmcgvug.js";import"./CountTo.vue_vue_type_script_setup_true_lang-Dr60QDIl.js";import"./index-Cr6_Qzhf.js";import"./el-checkbox-BVo36Tmv.js";import"./useInput-D-eMIzLG.js";import"./debounce-rCtyPgGe.js";import"./el-select-FArs2pTf.js";import"./el-image-viewer-CCnBYOdA.js";import"./tsxHelper-CyxpWgl3.js";import"./el-dropdown-item-CgW2TRYg.js";import"./castArray-B4xEQihS.js";import"./refs-ClXC3KCu.js";import"./index-CQSTts3C.js";import"./raf-P5NVVAw8.js";const V=s({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:o,default:"primary"},cancelButtonType:{type:String,values:o,default:"text"},icon:{type:l,default:()=>r},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1},hideAfter:{type:Number,default:200},teleported:D.teleported,persistent:D.persistent,width:{type:[String,Number],default:150}}),W={confirm:e=>e instanceof MouseEvent,cancel:e=>e instanceof MouseEvent},X=n({name:"ElPopconfirm"});const Y=A(S(n({...X,props:V,emits:W,setup(e,{emit:t}){const a=e,{t:s}=i(),o=p("popconfirm"),l=d(),r=()=>{var e,t;null==(t=null==(e=l.value)?void 0:e.onClose)||t.call(e)},n=m((()=>({width:c(a.width)}))),S=e=>{t("confirm",e),r()},A=e=>{t("cancel",e),r()},E=m((()=>a.confirmButtonText||s("el.popconfirm.confirmButtonText"))),U=m((()=>a.cancelButtonText||s("el.popconfirm.cancelButtonText")));return(e,t)=>(u(),f(h(H),N({ref_key:"tooltipRef",ref:l,trigger:"click",effect:"light"},e.$attrs,{"popper-class":`${h(o).namespace.value}-popover`,"popper-style":h(n),teleported:e.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":e.hideAfter,persistent:e.persistent}),{content:v((()=>[y("div",{class:g(h(o).b())},[y("div",{class:g(h(o).e("main"))},[!e.hideIcon&&e.icon?(u(),f(h(_),{key:0,class:g(h(o).e("icon")),style:b({color:e.iconColor})},{default:v((()=>[(u(),f(x(e.icon)))])),_:1},8,["class","style"])):k("v-if",!0),j(" "+w(e.title),1)],2),y("div",{class:g(h(o).e("action"))},[T(h(C),{size:"small",type:"text"===e.cancelButtonType?"":e.cancelButtonType,text:"text"===e.cancelButtonType,onClick:A},{default:v((()=>[j(w(h(U)),1)])),_:1},8,["type","text"]),T(h(C),{size:"small",type:"text"===e.confirmButtonType?"":e.confirmButtonType,text:"text"===e.confirmButtonType,onClick:S},{default:v((()=>[j(w(h(E)),1)])),_:1},8,["type","text"])],2)],2)])),default:v((()=>[e.$slots.reference?B(e.$slots,"reference",{key:0}):k("v-if",!0)])),_:3},16,["popper-class","popper-style","teleported","hide-after","persistent"]))}}),[["__file","popconfirm.vue"]])),Z=$(n({__name:"Analysis",setup(s){const{t:o}=P(),l=d(!0),r=E([{field:"nodeName",label:o("node.nodeName")},{field:"taskCount",label:o("node.taskCount"),formatter:(e,t,a)=>U(Q,{round:!0,effect:"dark"},(()=>a))},{field:"nodeStatus",label:o("node.nodeStatus"),formatter:(e,t,a)=>U(Q,{type:"1"===a?"success":"2"===a?"warning":"danger",effect:"dark"},(()=>o("1"==a?"node.statusRun":"2"==a?"node.statusStop":"node.statusError")))}]),n=E([{field:"name",label:o("task.taskName")},{field:"taskNum",label:o("task.taskCount"),formatter:(e,t,a)=>U(Q,{round:!0,effect:"dark"},(()=>a))},{field:"progress",label:o("task.taskProgress"),formatter:(e,t,a)=>U(J,{percentage:a,type:"line",striped:!0,status:a<100?"":"success",stripedFlow:a<100})},{field:"creatTime",label:o("task.createTime")}]),i=E([{field:"nodeName",label:o("node.nodeName")},{field:"nodeUsageCpu",label:o("node.nodeUsageCpu"),formatter:(e,t,a)=>{let s=parseFloat(a);return s=parseFloat(s.toFixed(2)),U(J,{percentage:s,type:"dashboard",color:s<50?"#26a33f":s<=80?"#fe9900":"#df2800"})}},{field:"nodeUsageMemory",label:o("node.nodeUsageMemory"),formatter:(e,t,a)=>{let s=parseFloat(a);return s=parseFloat(s.toFixed(2)),U(J,{percentage:s,type:"dashboard",color:s<50?"#26a33f":s<80?"#fe9900":"#df2800"})}}]),p=E([{field:"name",label:o("common.name")},{field:"cversion",label:o("common.cversion")},{field:"lversion",label:o("common.lversion"),formatter:(e,t,a)=>{if(e.cversion!=e.lversion){A.value=!0;const t=e.msg.split("\\n");let s="";return t.forEach((e=>{s+=`<div>${e}</div>`})),U(H,{placement:"top",content:s,rawContent:!0},[U(O,{type:"danger"},a)])}return U(O,a)}}]);let m=d([]);const c=d([]),g=async()=>{try{const e=await q();e&&e.data&&Array.isArray(e.data.list)&&(c.value=e.data.list.map((e=>({nodeName:e.name,taskCount:e.running,nodeStatus:e.state,nodeUsageCpu:e.cpuNum,nodeUsageMemory:e.memNum}))),m.value=E(e.data.list.map((e=>({nodeName:e.name,nodeUsageCpu:e.cpuNum,nodeUsageMemory:e.memNum})))))}catch(e){}finally{l.value=!1}},_=d([]),b=async()=>{const e=await L("",1,10);_.value=E(e.data.list.map((e=>({name:e.name,taskNum:e.taskNum,progress:e.progress,creatTime:e.creatTime}))))},x=d([]),B=async()=>{await Promise.all([g(),b()]),l.value=!1};(async()=>{const e=await t();x.value=E(e.data.list.map((e=>({name:e.name,cversion:e.cversion,lversion:e.lversion,msg:e.msg}))))})(),B();const N=setInterval(B,1e4);I((()=>{clearInterval(N)}));const S=async()=>{await a()},A=d(!1);return(t,a)=>(u(),M(F,null,[T(e),T(h(R),{gutter:20,justify:"space-between"},{default:v((()=>[T(h(z),{xl:12,lg:12,md:24,sm:24,xs:24},{default:v((()=>[T(h(G),{shadow:"hover",class:"mb-20px"},{header:v((()=>[y("span",null,w(h(o)("dashboard.nodeInfo")),1)])),default:v((()=>[T(h(K),{columns:r,data:c.value,stripe:"",border:!1,height:250},null,8,["columns","data"])])),_:1})])),_:1}),T(h(z),{xl:12,lg:12,md:24,sm:24,xs:24},{default:v((()=>[T(h(G),{shadow:"hover",class:"mb-20px"},{header:v((()=>[y("span",null,w(h(o)("dashboard.taskInfo")),1)])),default:v((()=>[T(h(K),{columns:n,data:_.value,stripe:"",border:!1,height:250,"tooltip-options":{offset:1,showArrow:!1,effect:"dark",enterable:!1,showAfter:0,popperOptions:{},popperClass:"test",placement:"bottom",hideAfter:0,disabled:!0}},null,8,["columns","data"])])),_:1})])),_:1}),T(h(z),{span:12},{default:v((()=>[T(h(G),{shadow:"hover",class:"mb-25px"},{header:v((()=>[y("div",null,[y("span",null,w(h(o)("node.nodeUsageStatus")),1)])])),default:v((()=>[T(h(K),{columns:i,data:h(m),highlightCurrentRow:!1,stripe:"",border:!1,height:600},null,8,["columns","data"])])),_:1})])),_:1}),T(h(z),{span:12},{default:v((()=>[T(h(G),{shadow:"hover",class:"mb-25px"},{header:v((()=>[T(h(R),null,{default:v((()=>[T(h(z),{span:12},{default:v((()=>[y("div",null,[y("span",null,w(h(o)("common.version")),1),A.value?(u(),f(h(O),{key:0,type:"danger",size:"small",style:{position:"relative",left:"1rem"}},{default:v((()=>[j("*"+w(h(o)("common.updatemsg")),1)])),_:1})):k("",!0)])])),_:1}),A.value?(u(),f(h(z),{key:0,span:3,offset:8},{default:v((()=>[T(h(Y),{title:"Are you sure?",onConfirm:S},{reference:v((()=>[T(h(C),{color:"#626aef"},{default:v((()=>[T(h(H),{content:h(o)("common.updateButtonMsg"),lacement:"top-start",effect:"dark"},{default:v((()=>[j(w(h(o)("common.update")),1)])),_:1},8,["content"])])),_:1})])),_:1})])),_:1})):k("",!0)])),_:1})])),default:v((()=>[T(h(K),{columns:p,data:x.value,stripe:"",border:!1,height:600},null,8,["columns","data"])])),_:1})])),_:1})])),_:1})],64))}}),[["__scopeId","data-v-6f354693"]]);export{Z as default};
