import{_ as e}from"./ContentWrap.vue_vue_type_script_setup_true_lang-B4sinkeh.js";import{d as a,N as t,e as l,a1 as o,I as r,r as s,X as i,Q as n,E as p,Y as u,o as m,c as d,w as c,a as h,$ as f,f as g,t as x,a4 as _,H as b,a0 as v,l as y,_ as j}from"./index-CbsoNNgc.js";import{_ as w}from"./Search.vue_vue_type_script_setup_true_lang-ChaJ0dKK.js";import{u as H}from"./useSearch-B7KyOfbH.js";import{u as k}from"./useTable-srm4bvKt.js";import{E as S}from"./el-card-Bu1pgq7H.js";import{E as z}from"./el-pagination-B4Yv1h_7.js";import"./el-tag-7Tafez-0.js";import"./el-popper-_HbrF1jO.js";import{E,a as P}from"./el-col-Dx3G6Gsk.js";import{_ as C,E as I,a as R}from"./Table.vue_vue_type_script_lang-DVJWTuWi.js";import"./el-checkbox-BX9zfJQq.js";import"./el-tooltip-l0sNRNKZ.js";import{E as U}from"./el-text-DlfLR9u9.js";import{E as V}from"./el-divider-CLgHEjVa.js";import{E as A}from"./el-link-C6EFH_TY.js";import{_ as W}from"./Dialog.vue_vue_type_style_index_0_lang-BiqtJw8z.js";import{u as M}from"./useCrudSchemas-BF5eLm3J.js";import{e as B,f as D,h as L}from"./index-Dr24QQr2.js";import"./useForm-DsUJ7Tn1.js";import"./el-form-item-4OkArQhq.js";import"./castArray-DuA9ouXu.js";import"./el-radio-group-D8MIitN0.js";/* empty css                          */import"./el-input-number-Bp7g6PFD.js";import"./el-select-v2-BfawHYzJ.js";import"./raf-C-vZNDhD.js";import"./useInput-Kf9RVEEH.js";import"./debounce-wcc1GRYs.js";import"./el-switch-CgsPf83W.js";import"./el-progress-CzAr_jmg.js";import"./InputPassword-DU4kh0H3.js";import"./style.css_vue_type_style_index_0_src_true_lang-ioP-pxAB.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-DCMqnrji.js";import"./IconPicker-DfOuf_af.js";/* empty css                   */import"./el-tab-pane-DlW0wfXF.js";import"./tsxHelper-Cn8_hiAG.js";import"./index-QCvozDUF.js";import"./useIcon-DZCueV0L.js";import"./el-image-viewer-BySdG1W0.js";import"./el-dropdown-item-DPuD6G3N.js";import"./refs-Bj8u2PxR.js";import"./index-Dh6wrwZi.js";import"./tree-BfZhwLPs.js";import"./index-pyCy64cM.js";const N={style:{color:"red"}},O={style:{whiteSpace:"pre-line"}};function q(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!v(e)}const F=j(a({__name:"PageMonitoring",setup(a){const{t:v}=y(),{searchRegister:j}=H(),F=t([{field:"search",label:v("form.input"),component:"Input",formItemProps:{size:"large",style:{width:"100%"}},componentProps:{clearable:!1,slots:{suffix:()=>l(r,{class:"icon-button",onClick:Y,text:!0,style:"outline: none;background-color: transparent !important; color: inherit !important; box-shadow: none !important;position: relative;left: 24%"},{default:()=>[l(o,{icon:"tdesign:chat-bubble-help"},null)]})}}}]),T=[{operator:"=",meaning:v("searchHelp.like")},{operator:"!=",meaning:v("searchHelp.notIn")},{operator:"==",meaning:v("searchHelp.equal")},{operator:"&&",meaning:v("searchHelp.and")},{operator:"||",meaning:v("searchHelp.or")},{operator:"()",meaning:v("searchHelp.brackets")}],Q=[{keyword:"url",example:'url="http://example.com"',explain:v("searchHelp.url")},{keyword:"hash",example:'hash="234658675623543"',explain:v("searchHelp.hash")},{keyword:"matched",example:'matched="https://example.com"',explain:v("searchHelp.matched")},{keyword:"diff",example:'diff="example"',explain:v("searchHelp.diff")},{keyword:"response",example:'response="root"',explain:v("searchHelp.response")},{keyword:"project",example:'project="Hackerone"',explain:v("searchHelp.project")}],X=s(!1),Y=()=>{X.value=!0},G=s(!0),J=s("inline"),K=s("left"),Z=s(""),$=e=>{Z.value=e.search,ve()},ee=s(!1),ae=t([{field:"index",label:v("tableDemo.index"),type:"index",minWidth:10},{field:"url",label:"url",minWidth:50,formatter:(e,a,t)=>l(A,{href:t,underline:!1},q(t)?t:{default:()=>[t]})},{field:"response1",label:v("PageMonitoring.oldResponseBody"),minWidth:12,formatter:(e,a,t)=>{let o;return l(n,null,[l(i,{type:"info",size:"small",onClick:()=>re(e.id,"1")},q(o=v("common.view"))?o:{default:()=>[o]})])}},{field:"respone2",label:v("PageMonitoring.currentResponseBody"),minWidth:12,formatter:(e,a,t)=>{let o;return l(n,null,[l(i,{type:"info",size:"small",onClick:()=>re(e.id,"2")},q(o=v("common.view"))?o:{default:()=>[o]})])}},{field:"diff",label:"diff",formatter:(e,a,t)=>{const o=t.split("\n").map(((e,a)=>l("div",{key:a},[e])));return l(p,{minSize:10,maxHeight:200},{default:()=>[l("div",{class:"scrollbar-demo-item"},[o])]})}},{field:"action",label:v("tableDemo.action"),minWidth:30,formatter:(e,a,t)=>{let o;return l(n,null,[l(i,{type:"success",onClick:()=>ie(e.id)},q(o=v("asset.historyDiff"))?o:{default:()=>[o]})])}}]),te=s(!1),le=s(""),oe=s(""),re=async(e,a)=>{const t=await B(e,a);se(t.data.content,t.data.hash)},se=(e,a)=>{te.value=!0,le.value=e,oe.value=a},ie=async e=>{const a=await D(e);ue(a.data.diff)},ne=s(!1),pe=s([]),ue=e=>{pe.value=e,ne.value=!0},{allSchemas:me}=M(ae),{tableRegister:de,tableState:ce,tableMethods:he}=k({fetchDataApi:async()=>{const{currentPage:e,pageSize:a}=ce,t=await L(Z.value,e.value,a.value);return{list:t.data.list,total:t.data.total}},immediate:!1}),{loading:fe,dataList:ge,total:xe,currentPage:_e,pageSize:be}=ce,{getList:ve}=he;function ye(){return{background:"var(--el-fill-color-light)"}}ve(),u((()=>{we(),window.addEventListener("resize",we)}));const je=s(0),we=()=>{const e=window.innerHeight||document.documentElement.clientHeight;je.value=.7*e};return(a,t)=>(m(),d(n,null,[l(h(e),{style:{height:"80px"}},{default:c((()=>[l(h(w),{schema:F,"is-col":G.value,layout:J.value,"show-reset":!1,"button-position":K.value,"search-loading":ee.value,onSearch:$,onReset:$,onRegister:h(j)},null,8,["schema","is-col","layout","button-position","search-loading","onRegister"])])),_:1}),l(h(P),null,{default:c((()=>[l(h(E),null,{default:c((()=>[l(h(S),null,{default:c((()=>[l(h(C),{pageSize:h(be),"onUpdate:pageSize":t[0]||(t[0]=e=>f(be)?be.value=e:null),currentPage:h(_e),"onUpdate:currentPage":t[1]||(t[1]=e=>f(_e)?_e.value=e:null),columns:h(me).tableColumns,data:h(ge),"max-height":je.value,stripe:"",border:!0,loading:h(fe),resizable:!0,onRegister:h(de),headerCellStyle:ye,tooltipOptions:{disabled:!0,showArrow:!1,effect:"dark",enterable:!1,offset:0,placement:"top",popperClass:"",popperOptions:{},showAfter:0,hideAfter:0},style:{fontFamily:"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji"}},null,8,["pageSize","currentPage","columns","data","max-height","loading","onRegister"])])),_:1})])),_:1}),l(h(E),{":span":24},{default:c((()=>[l(h(S),null,{default:c((()=>[l(h(z),{pageSize:h(be),"onUpdate:pageSize":t[2]||(t[2]=e=>f(be)?be.value=e:null),currentPage:h(_e),"onUpdate:currentPage":t[3]||(t[3]=e=>f(_e)?_e.value=e:null),"page-sizes":[10,20,50,100,200,500,1e3],layout:"total, sizes, prev, pager, next, jumper",total:h(xe)},null,8,["pageSize","currentPage","total"])])),_:1})])),_:1})])),_:1}),l(h(W),{modelValue:te.value,"onUpdate:modelValue":t[4]||(t[4]=e=>te.value=e),title:"ResponseBody",center:"",style:{"border-radius":"15px","box-shadow":"5px 5px 10px rgba(0, 0, 0, 0.3)"},width:"70%","max-height":je.value},{default:c((()=>[l(h(p),{"max-height":je.value},{default:c((()=>[g("div",N,"Hash: "+x(oe.value),1),l(h(V)),g("div",O,x(le.value),1)])),_:1},8,["max-height"])])),_:1},8,["modelValue","max-height"]),l(h(W),{modelValue:ne.value,"onUpdate:modelValue":t[5]||(t[5]=e=>ne.value=e),title:"Historical changes",center:"",style:{"border-radius":"15px","box-shadow":"5px 5px 10px rgba(0, 0, 0, 0.3)"},width:"70%","max-height":je.value},{default:c((()=>[g("div",null,[(m(!0),d(n,null,_(pe.value,((e,a)=>(m(),d("div",{key:a,style:{whiteSpace:"pre-line"}},[l(h(U),null,{default:c((()=>[b(x(e),1)])),_:2},1024),l(h(V),{style:{background:"#e99696"}})])))),128))])])),_:1},8,["modelValue","max-height"]),l(h(W),{modelValue:X.value,"onUpdate:modelValue":t[6]||(t[6]=e=>X.value=e),title:h(v)("common.querysyntax"),center:"",style:{"border-radius":"15px","box-shadow":"5px 5px 10px rgba(0, 0, 0, 0.3)"}},{default:c((()=>[l(h(P),null,{default:c((()=>[l(h(E),null,{default:c((()=>[l(h(U),{tag:"b",size:"small"},{default:c((()=>[b(x(h(v)("searchHelp.operator")),1)])),_:1}),l(h(V),{direction:"vertical"}),l(h(U),{size:"small",type:"danger"},{default:c((()=>[b(x(h(v)("searchHelp.notice")),1)])),_:1})])),_:1}),l(h(E),{style:{"margin-top":"10px"}},{default:c((()=>[l(h(I),{headerCellStyle:ye,data:T},{default:c((()=>[l(h(R),{prop:"operator",label:h(v)("searchHelp.operator"),width:"300"},null,8,["label"]),l(h(R),{prop:"meaning",label:h(v)("searchHelp.meaning")},null,8,["label"])])),_:1})])),_:1}),l(h(E),{style:{"margin-top":"15px"}},{default:c((()=>[l(h(U),{tag:"b",size:"small"},{default:c((()=>[b(x(h(v)("searchHelp.keywords")),1)])),_:1})])),_:1}),l(h(E),{style:{"margin-top":"10px"}},{default:c((()=>[l(h(I),{headerCellStyle:ye,data:Q},{default:c((()=>[l(h(R),{prop:"keyword",label:h(v)("searchHelp.keywords")},null,8,["label"]),l(h(R),{prop:"example",label:h(v)("searchHelp.example")},null,8,["label"]),l(h(R),{prop:"explain",label:h(v)("searchHelp.explain")},null,8,["label"])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue","title"])],64))}}),[["__scopeId","data-v-d2ded639"]]);export{F as default};
