import{d as e,r as t,N as a,e as l,a1 as i,E as o,X as r,Q as s,Y as n,o as p,c as m,a as d,w as u,$ as c,f,t as g,a0 as h,l as _,_ as j}from"./index-RTeQX4Z1.js";import{u as v}from"./useTable-C6AO1hlT.js";import{E as x}from"./el-card-DvuZ99w3.js";import{E as y}from"./el-select-2HzOgPi7.js";import"./el-tag-DQ-f6KyF.js";import"./el-popper-BiF-N6C2.js";import{E as b,a as S}from"./el-col-Clk25fNT.js";import{_ as w}from"./Dialog.vue_vue_type_style_index_0_lang-k1HJRGzw.js";import{_ as k}from"./Table.vue_vue_type_script_lang-ZyLIndS7.js";import{u as z}from"./useCrudSchemas-0r96tsm6.js";import{i as H,j as C}from"./index-By1llXOp.js";import{_ as I}from"./Csearch.vue_vue_type_script_setup_true_lang-Bx1YW-Iz.js";import"./useInput-Bmcy5cuV.js";import"./debounce-DUkqpuCQ.js";import"./refs-BEkOJGIm.js";import"./el-checkbox-bH4fVny5.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-image-viewer-CRlDfJN9.js";import"./tsxHelper-b5SIzQmu.js";import"./el-dropdown-item-D_iEt1B1.js";import"./castArray-Cj9r5Aws.js";import"./index-hI19neGk.js";import"./raf-BzIIckEj.js";import"./tree-BfZhwLPs.js";import"./index-EWI9jeY3.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-mUK4Q3hP.js";import"./el-text-CpyCtW8d.js";import"./el-divider-C9tmp1am.js";import"./el-form-item-Bth-RQFo.js";import"./useIcon-KJLOguoe.js";import"./exportData.vue_vue_type_script_setup_true_lang-BVgd2c1w.js";import"./el-tab-pane-C7IMVA71.js";import"./el-radio-group-C3cxfPRm.js";const U={style:{whiteSpace:"pre-line"}};const E=j(e({__name:"SensitiveInformation",setup(e){const{t:j}=_(),E=[{keyword:"url",example:'url="http://example.com"',explain:j("searchHelp.url")},{keyword:"sname",example:'sname="twilio_account_sid"',explain:j("searchHelp.sname")},{keyword:"body",example:'body="api-key-example"',explain:j("searchHelp.body")},{keyword:"info",example:'info="api-key-example"',explain:j("searchHelp.sinfo")},{keyword:"project",example:'project="Hackerone"',explain:j("searchHelp.project")},{keyword:"md5",example:'md5=="1d49e5e190f7a38ab498e28e6578f64f"',explain:j("searchHelp.sensMd5")}],W=t(""),P=e=>{W.value=e,F()},A=a([{field:"index",label:j("tableDemo.index"),type:"index",minWidth:10},{field:"url",label:"URL",minWidth:50},{field:"name",label:j("sensitiveInformation.sensitiveName"),minWidth:15},{field:"color",label:"Level",minWidth:7,formatter:(e,t,a)=>l(i,{icon:"clarity:circle-solid",color:a,style:"transform: translateY(-35%)"},null)},{field:"match",label:"Info",minWidth:50,formatter:(e,t,a)=>{const i=a.map(((e,t)=>l("div",{key:t},[e])));return l(o,{height:"100px"},{default:()=>[l("div",{class:"scrollbar-demo-item"},[i])]})}},{field:"time",label:j("asset.time"),minWidth:30},{field:"action",label:j("tableDemo.action"),formatter:(e,t,a)=>{let i;return l(s,null,[l(r,{type:"primary",onClick:()=>G(e.id)},(o=i=j("asset.detail"),"function"==typeof o||"[object Object]"===Object.prototype.toString.call(o)&&!h(o)?i:{default:()=>[i]}))]);var o},minWidth:10}]),{allSchemas:D}=z(A),{tableRegister:L,tableState:N,tableMethods:R}=v({fetchDataApi:async()=>{const{currentPage:e,pageSize:t}=N,a=await C(W.value,e.value,t.value);return{list:a.data.list,total:a.data.total}},immediate:!1}),{loading:M,dataList:O,total:T,currentPage:V,pageSize:Y}=N,{getList:F}=R;function K(){return{background:"var(--el-fill-color-light)"}}F(),n((()=>{$(),window.addEventListener("resize",$)}));const X=t(0),$=()=>{const e=window.innerHeight||document.documentElement.clientHeight;X.value=.7*e},q=t(!1),B=t(""),G=async e=>{const t=await H(e);B.value=t.data.body,q.value=!0};return(e,t)=>(p(),m(s,null,[l(I,{getList:d(F),handleSearch:P,searchKeywordsData:E,index:"SensitiveResult"},null,8,["getList"]),l(d(S),null,{default:u((()=>[l(d(b),null,{default:u((()=>[l(d(x),null,{default:u((()=>[l(d(k),{pageSize:d(Y),"onUpdate:pageSize":t[0]||(t[0]=e=>c(Y)?Y.value=e:null),currentPage:d(V),"onUpdate:currentPage":t[1]||(t[1]=e=>c(V)?V.value=e:null),columns:d(D).tableColumns,data:d(O),stripe:"",border:!0,"max-height":X.value,loading:d(M),resizable:!0,onRegister:d(L),headerCellStyle:K,"tooltip-options":{offset:1,showArrow:!1,effect:"dark",enterable:!0,showAfter:0,popperOptions:{},popperClass:"test",placement:"top",hideAfter:0,disabled:!1},style:{fontFamily:"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji"}},null,8,["pageSize","currentPage","columns","data","max-height","loading","onRegister"])])),_:1})])),_:1}),l(d(b),{":span":24},{default:u((()=>[l(d(x),null,{default:u((()=>[l(d(y),{pageSize:d(Y),"onUpdate:pageSize":t[2]||(t[2]=e=>c(Y)?Y.value=e:null),currentPage:d(V),"onUpdate:currentPage":t[3]||(t[3]=e=>c(V)?V.value=e:null),"page-sizes":[10,20,50,100,200,500,1e3],layout:"total, sizes, prev, pager, next, jumper",total:d(T)},null,8,["pageSize","currentPage","total"])])),_:1})])),_:1})])),_:1}),l(d(w),{modelValue:q.value,"onUpdate:modelValue":t[4]||(t[4]=e=>q.value=e),title:d(j)("asset.detail"),center:"",style:{"border-radius":"15px","box-shadow":"5px 5px 10px rgba(0, 0, 0, 0.3)"},width:"70%","max-height":X.value},{default:u((()=>[l(d(o),{"max-height":X.value},{default:u((()=>[f("div",U,g(B.value),1)])),_:1},8,["max-height"])])),_:1},8,["modelValue","title","max-height"])],64))}}),[["__scopeId","data-v-35419331"]]);export{E as default};
