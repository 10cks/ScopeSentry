import{d as e,N as a,e as t,r as l,o,i,w as r,a as s,H as n,t as d,Z as p,I as m,l as u}from"./index-RTeQX4Z1.js";import{E as f,a as c}from"./el-tab-pane-C7IMVA71.js";import{E as b,a as y}from"./el-form-item-Bth-RQFo.js";import{a as x,E as h}from"./el-radio-group-C3cxfPRm.js";import{r as _}from"./index-EWI9jeY3.js";import{_ as v}from"./Table.vue_vue_type_script_lang-ZyLIndS7.js";import{u as g}from"./useTable-C6AO1hlT.js";const j=e({__name:"exportData",props:{index:{},searchParams:{}},setup(e){const{t:j}=u(),S=e,U=a({type:"all",quantity:0}),V=async()=>{var e,a,t,l;C.value=!0,await(e=S.index,a=U.quantity,t=U.type,l=S.searchParams,_.post({url:"/api/export",data:{index:e,quantity:a,type:t,search:l}})),C.value=!1},W=a([{field:"index",label:j("tableDemo.index"),type:"index",minWidth:10},{field:"url",label:"URL",minWidth:30},{field:"vulnerability",label:"Vulnerability",minWidth:20},{field:"level",label:"Level",minWidth:10,formatter:(e,a,l)=>{if(null==l)return t("div",null,null);6===l?j("poc.critical"):5===l?j("poc.high"):4===l?j("poc.medium"):3===l?j("poc.low"):2===l?j("poc.info"):1===l&&j("poc.unknown")}},{field:"matched",label:"Matched",minWidth:30},{field:"time",label:j("asset.time"),minWidth:20},{field:"action",label:j("tableDemo.action"),minWidth:10}]),{tableRegister:w,tableState:E,tableMethods:R}=g({fetchDataApi:async()=>{const e=await _.get({url:"/api/export/record"});return{total:e.data.total,list:e.data.list}},immediate:!1}),{dataList:q}=E,C=l(!1);return(e,a)=>(o(),i(s(c),{tabPosition:"left"},{default:r((()=>[t(s(f),{label:s(j)("asset.export")},{default:r((()=>[t(s(b),{model:U,"label-width":"auto",style:{position:"relative"}},{default:r((()=>[t(s(y),{label:s(j)("export.exportType")},{default:r((()=>[t(s(x),{modelValue:U.type,"onUpdate:modelValue":a[0]||(a[0]=e=>U.type=e)},{default:r((()=>[t(s(h),{value:"all"},{default:r((()=>[n(d(s(j)("export.exportTypeAll")),1)])),_:1}),t(s(h),{value:"search"},{default:r((()=>[n(d(s(j)("export.exportTypeSearch")),1)])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["label"]),t(s(y),{label:s(j)("export.exportQuantity")},{default:r((()=>[t(s(p),{modelValue:U.quantity,"onUpdate:modelValue":a[1]||(a[1]=e=>U.quantity=e)},null,8,["modelValue"])])),_:1},8,["label"]),t(s(y),null,{default:r((()=>[t(s(m),{type:"primary",onClick:V,style:{left:"40%",position:"relative"},loading:C.value},{default:r((()=>[n(" Create ")])),_:1},8,["loading"])])),_:1})])),_:1},8,["model"])])),_:1},8,["label"]),t(s(f),{label:s(j)("export.exportRecords")},{default:r((()=>[t(s(v),{onRegister:s(w),columns:W,data:s(q),"max-height":"500",style:{fontFamily:"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji"}},null,8,["onRegister","columns","data"])])),_:1},8,["label"])])),_:1}))}});export{j as _};
