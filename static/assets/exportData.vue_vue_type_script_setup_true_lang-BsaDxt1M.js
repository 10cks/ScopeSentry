import{s as e,d as t,A as a,B as l,O as r,J as o,r as i,bf as s,ad as n,ab as u,e as d,dE as p,a0 as c,H as f,a7 as m,ac as y,cl as x,dF as v,dG as h,M as g,N as b,X as S,Q as w,o as _,i as E,w as j,a as C,t as T,Z as A,I as R,l as k}from"./index-DDHcjopZ.js";import{E as O,a as z}from"./el-tab-pane-BhIgdPAB.js";import{E as L,a as N}from"./el-form-item-D0ZdsA3F.js";import{a as P,E as $}from"./el-radio-group-BTwue__K.js";import{E as I}from"./el-tag-CAhOIzri.js";import{r as U}from"./index-DXl3uH5Z.js";import{_ as V}from"./Table.vue_vue_type_script_lang-DQcq6jzp.js";import{u as q}from"./useTable-DLJVogQf.js";const B=t({name:"ElSpaceItem",props:e({prefixCls:{type:String}}),setup(e,{slots:t}){const i=a("space"),s=l((()=>`${e.prefixCls||i.b()}__item`));return()=>r("div",{class:s.value},o(t,"default"))}}),G={small:8,default:12,large:16};const M=g(t({name:"ElSpace",props:e({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},class:{type:m([String,Object,Array]),default:""},style:{type:m([String,Array,Object]),default:""},alignment:{type:m(String),default:"center"},prefixCls:{type:String},spacer:{type:m([Object,String,Number,Array]),default:null,validator:e=>c(e)||u(e)||y(e)},wrap:Boolean,fill:Boolean,fillRatio:{type:Number,default:100},size:{type:[String,Array,Number],values:x,validator:e=>u(e)||n(e)&&2===e.length&&e.every(u)}}),setup(e,{slots:t}){const{classes:r,containerStyle:m,itemStyle:y}=function(e){const t=a("space"),r=l((()=>[t.b(),t.m(e.direction),e.class])),o=i(0),d=i(0),p=l((()=>[e.wrap||e.fill?{flexWrap:"wrap"}:{},{alignItems:e.alignment},{rowGap:`${d.value}px`,columnGap:`${o.value}px`},e.style])),c=l((()=>e.fill?{flexGrow:1,minWidth:`${e.fillRatio}%`}:{}));return s((()=>{const{size:t="small",wrap:a,direction:l,fill:r}=e;if(n(t)){const[e=0,a=0]=t;o.value=e,d.value=a}else{let e;e=u(t)?t:G[t||"small"]||G.small,(a||r)&&"horizontal"===l?o.value=d.value=e:"horizontal"===l?(o.value=e,d.value=0):(d.value=e,o.value=0)}})),{classes:r,containerStyle:p,itemStyle:c}}(e);function x(t,a="",l=[]){const{prefixCls:r}=e;return t.forEach(((e,t)=>{v(e)?n(e.children)&&e.children.forEach(((e,t)=>{v(e)&&n(e.children)?x(e.children,`${a+t}-`,l):l.push(d(B,{style:y.value,prefixCls:r,key:`nested-${a+t}`},{default:()=>[e]},p.PROPS|p.STYLE,["style","prefixCls"]))})):h(e)&&l.push(d(B,{style:y.value,prefixCls:r,key:`LoopKey${a+t}`},{default:()=>[e]},p.PROPS|p.STYLE,["style","prefixCls"]))})),l}return()=>{var a;const{spacer:l,direction:i}=e,s=o(t,"default",{key:0},(()=>[]));if(0===(null!=(a=s.children)?a:[]).length)return null;if(n(s.children)){let e=x(s.children);if(l){const t=e.length-1;e=e.reduce(((e,a,r)=>{const o=[...e,a];return r!==t&&o.push(d("span",{style:[y.value,"vertical"===i?"width: 100%":null],key:r},[c(l)?l:f(l,p.TEXT)],p.STYLE)),o}),[])}return d("div",{class:r.value,style:m.value},e,p.STYLE|p.CLASS)}return s.children}}})),Y=e=>U.post({url:"/api/export/delete",data:{ids:e}});function D(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!c(e)}const F=t({__name:"exportData",props:{index:{},searchParams:{}},setup(e){const{t:t}=k(),a=e,l=b({type:"all",quantity:0}),r=async()=>{var e,t,r,o;v.value=!0,await(e=a.index,t=l.quantity,r=l.type,o=a.searchParams,U.post({url:"/api/export",data:{index:e,quantity:t,type:r,search:o}})),v.value=!1},o=b([{field:"selection",type:"selection"},{field:"file_name",label:t("export.fileName"),width:"160"},{field:"state",label:t("export.state"),formatter:(e,a,l)=>{if(0==l){let e;return d(I,{type:"info"},D(e=t("export.wait"))?e:{default:()=>[e]})}if(1==l){let e;return d(I,{type:"success"},D(e=t("export.success"))?e:{default:()=>[e]})}{let e;return d(I,{type:"danger"},D(e=t("export.fail"))?e:{default:()=>[e]})}}},{field:"create_time",label:t("export.createTime"),width:"160"},{field:"end_time",label:t("export.endTime"),width:"160",formatter:(e,t,a)=>""==a?"-":a},{field:"data_type",label:t("export.type"),width:"120"},{field:"file_size",label:t("export.fileSize"),width:"100",formatter:(e,t,a)=>""==a?"-":a+" MB"},{field:"action",label:t("tableDemo.action"),width:"200",formatter:(e,a,l)=>{let r,o;return d(w,null,[d(S,{type:"success",onClick:()=>x(e.file_name)},D(r=t("export.download"))?r:{default:()=>[r]}),d(S,{type:"danger",onClick:()=>B(e)},D(o=t("common.delete"))?o:{default:()=>[o]})])}}]),{tableRegister:s,tableState:n,tableMethods:u}=q({fetchDataApi:async()=>({list:(await U.get({url:"/api/export/record"})).data.list}),immediate:!1}),{dataList:p,loading:c}=n,{getList:m,getElTableExpose:y}=u,x=async e=>{const t=document.createElement("a");t.href="/api/export/download?file_name="+e,t.click()},v=i(!1),h=e=>{"exportRecords"==e&&m()},g=i(!1),B=async e=>{window.confirm("Are you sure you want to delete the selected data?")&&await G(e)},G=async e=>{g.value=!0;try{await Y([e.file_name]);g.value=!1,m()}catch(t){g.value=!1,m()}},F=async()=>{window.confirm("Are you sure you want to delete the selected data?")&&await Q()},H=i([]),Q=async()=>{const e=await y(),t=(null==e?void 0:e.getSelectionRows())||[];H.value=t.map((e=>e.file_name)),g.value=!0;try{await Y(H.value);g.value=!1,m()}catch(a){g.value=!1,m()}};return(e,a)=>(_(),E(C(z),{tabPosition:"left",onTabChange:h,"model-value":"export"},{default:j((()=>[d(C(O),{label:C(t)("asset.export"),name:"export"},{default:j((()=>[d(C(L),{model:l,"label-width":"auto",style:{position:"relative"}},{default:j((()=>[d(C(N),{label:C(t)("export.exportType")},{default:j((()=>[d(C(P),{modelValue:l.type,"onUpdate:modelValue":a[0]||(a[0]=e=>l.type=e)},{default:j((()=>[d(C($),{value:"all"},{default:j((()=>[f(T(C(t)("export.exportTypeAll")),1)])),_:1}),d(C($),{value:"search"},{default:j((()=>[f(T(C(t)("export.exportTypeSearch")),1)])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["label"]),d(C(N),{label:C(t)("export.exportQuantity")},{default:j((()=>[d(C(A),{modelValue:l.quantity,"onUpdate:modelValue":a[1]||(a[1]=e=>l.quantity=e)},null,8,["modelValue"])])),_:1},8,["label"]),d(C(N),null,{default:j((()=>[d(C(R),{type:"primary",onClick:r,style:{left:"40%",position:"relative"},loading:v.value},{default:j((()=>[f(" Create ")])),_:1},8,["loading"])])),_:1})])),_:1},8,["model"])])),_:1},8,["label"]),d(C(O),{label:C(t)("export.exportRecords"),name:"exportRecords"},{default:j((()=>[d(C(M),{direction:"vertical",alignment:"flex-start"},{default:j((()=>[d(C(S),{type:"danger",loading:g.value,onClick:F},{default:j((()=>[f(T(C(t)("common.delete")),1)])),_:1},8,["loading"]),d(C(V),{onRegister:C(s),columns:o,data:C(p),loading:C(c),"max-height":"500",style:{fontFamily:"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji"}},null,8,["onRegister","columns","data","loading"])])),_:1})])),_:1},8,["label"])])),_:1}))}});export{F as _};
