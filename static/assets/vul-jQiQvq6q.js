import{_ as e}from"./ContentWrap.vue_vue_type_script_setup_true_lang-F13nrP2r.js";import{d as l,a5 as t,dt as a,b9 as r,a2 as s,D as o,v as i,ba as n,U as p,V as u,a as c,o as d,c as m,f as h,F as g,P as f,i as b,e as v,a4 as y,aG as _,aN as x,bi as j,a1 as w,a3 as S,n as k,R as H,y as R,t as z,j as E,cX as U,ac as I,ad as L,s as P,M as C,z as D,r as N,G as V,H as W,B as q,w as A,K as $,L as M,l as T,_ as F}from"./index-KWTKF9N9.js";import{_ as B}from"./Search.vue_vue_type_script_setup_true_lang-MwhZHz4J.js";import{u as G}from"./useSearch-uQSWs8o5.js";import{u as O}from"./useTable-CuwOU5m7.js";import{E as J}from"./el-card-9F69xyLv.js";import{E as K}from"./el-pagination-ooblyvhx.js";import"./el-tag-MzjVikBY.js";import"./el-popper-pnFa2Ecw.js";import{E as X,a as Q}from"./el-col-t_F-vIr3.js";import{_ as Z,E as Y,a as ee}from"./Table.vue_vue_type_script_lang-iUd8q4UT.js";import"./el-checkbox-U1iRgEY7.js";import"./el-tooltip-w40geAFS.js";import{E as le}from"./el-text-bFj0OZ8x.js";import{E as te}from"./el-divider-685xvbVJ.js";import{_ as ae}from"./Dialog.vue_vue_type_style_index_0_lang-T5U2It3I.js";import{u as re}from"./useCrudSchemas-BjcgjN1n.js";import{r as se}from"./index-XFn6QxJu.js";import"./useForm-56lhuV1Q.js";import"./el-form-item-i8ZQhvu8.js";import"./castArray-9Ouy5Ghy.js";import"./el-radio-group-MC2AFabc.js";/* empty css                          */import"./el-input-number-Rb_QWPs-.js";import"./el-select-v2-0dTEd5GK.js";import"./raf-kE1zktlZ.js";import"./useInput-CGBP5_dt.js";import"./debounce-QvfGQs-0.js";import"./el-switch-tqt83myp.js";import"./el-progress-FyGDfwQU.js";import"./InputPassword-ytPGiHvf.js";import"./style.css_vue_type_style_index_0_src_true_lang-T2eDEypv.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-Z2SkzOTF.js";import"./IconPicker-f4TkQ97P.js";import"./el-tab-pane-fTldm5Oi.js";import"./tsxHelper-NOZkKkVH.js";import"./index-JT69SAQu.js";import"./useIcon-Ry17CHl2.js";import"./el-image-viewer-S1bd3VyN.js";import"./el-dropdown-item-bjCsATwt.js";import"./refs-WVQk01D0.js";import"./index-BS1c_xid.js";import"./tree-1FtpebiE.js";const oe=Symbol("elDescriptions");var ie=l({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup:()=>({descriptions:t(oe,{})}),render(){var e,l,t,p,u,c,d;const m=a(this.cell),h=((null==(e=this.cell)?void 0:e.dirs)||[]).map((e=>{const{dir:l,arg:t,modifiers:a,value:r}=e;return[l,r,t,a]})),{border:g,direction:f}=this.descriptions,b="vertical"===f,v=(null==(p=null==(t=null==(l=this.cell)?void 0:l.children)?void 0:t.label)?void 0:p.call(t))||m.label,y=null==(d=null==(c=null==(u=this.cell)?void 0:u.children)?void 0:c.default)?void 0:d.call(c),_=m.span,x=m.align?`is-${m.align}`:"",j=m.labelAlign?`is-${m.labelAlign}`:x,w=m.className,S=m.labelClassName,k={width:r(m.width),minWidth:r(m.minWidth)},H=s("descriptions");switch(this.type){case"label":return o(i(this.tag,{style:k,class:[H.e("cell"),H.e("label"),H.is("bordered-label",g),H.is("vertical-label",b),j,S],colSpan:b?_:1},v),h);case"content":return o(i(this.tag,{style:k,class:[H.e("cell"),H.e("content"),H.is("bordered-content",g),H.is("vertical-content",b),x,w],colSpan:b?_:2*_-1},y),h);default:return o(i("td",{style:k,class:[H.e("cell"),x],colSpan:_},[n(v)?void 0:i("span",{class:[H.e("label"),S]},v),i("span",{class:[H.e("content"),w]},y)]),h)}}});const ne=p({row:{type:u(Array),default:()=>[]}}),pe={key:1},ue=l({name:"ElDescriptionsRow"});var ce=y(l({...ue,props:ne,setup(e){const l=t(oe,{});return(e,t)=>"vertical"===c(l).direction?(d(),m(g,{key:0},[h("tr",null,[(d(!0),m(g,null,f(e.row,((e,l)=>(d(),b(c(ie),{key:`tr1-${l}`,cell:e,tag:"th",type:"label"},null,8,["cell"])))),128))]),h("tr",null,[(d(!0),m(g,null,f(e.row,((e,l)=>(d(),b(c(ie),{key:`tr2-${l}`,cell:e,tag:"td",type:"content"},null,8,["cell"])))),128))])],64)):(d(),m("tr",pe,[(d(!0),m(g,null,f(e.row,((e,t)=>(d(),m(g,{key:`tr3-${t}`},[c(l).border?(d(),m(g,{key:0},[v(c(ie),{cell:e,tag:"td",type:"label"},null,8,["cell"]),v(c(ie),{cell:e,tag:"td",type:"content"},null,8,["cell"])],64)):(d(),b(c(ie),{key:1,cell:e,tag:"td",type:"both"},null,8,["cell"]))],64)))),128))]))}}),[["__file","descriptions-row.vue"]]);const de=p({border:{type:Boolean,default:!1},column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:_,title:{type:String,default:""},extra:{type:String,default:""}}),me=l({name:"ElDescriptions"});var he=y(l({...me,props:de,setup(e){const l=e,t=s("descriptions"),a=x(),r=j();w(oe,l);const o=S((()=>[t.b(),t.m(a.value)])),i=(e,l,t,a=!1)=>(e.props||(e.props={}),l>t&&(e.props.span=t),a&&(e.props.span=l),e),n=()=>{if(!r.default)return[];const e=U(r.default()).filter((e=>{var l;return"ElDescriptionsItem"===(null==(l=null==e?void 0:e.type)?void 0:l.name)})),t=[];let a=[],s=l.column,o=0;return e.forEach(((r,n)=>{var p;const u=(null==(p=r.props)?void 0:p.span)||1;if(n<e.length-1&&(o+=u>s?s:u),n===e.length-1){const e=l.column-o%l.column;return a.push(i(r,e,s,!0)),void t.push(a)}u<s?(s-=u,a.push(r)):(a.push(i(r,u,s)),t.push(a),s=l.column,a=[])})),t};return(e,l)=>(d(),m("div",{class:k(c(o))},[e.title||e.extra||e.$slots.title||e.$slots.extra?(d(),m("div",{key:0,class:k(c(t).e("header"))},[h("div",{class:k(c(t).e("title"))},[H(e.$slots,"title",{},(()=>[R(z(e.title),1)]))],2),h("div",{class:k(c(t).e("extra"))},[H(e.$slots,"extra",{},(()=>[R(z(e.extra),1)]))],2)],2)):E("v-if",!0),h("div",{class:k(c(t).e("body"))},[h("table",{class:k([c(t).e("table"),c(t).is("bordered",e.border)])},[h("tbody",null,[(d(!0),m(g,null,f(n(),((e,l)=>(d(),b(ce,{key:l,row:e},null,8,["row"])))),128))])],2)],2)],2))}}),[["__file","description.vue"]]);const ge=l({name:"ElDescriptionsItem",props:p({label:{type:String,default:""},span:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}})}),fe=I(he,{DescriptionsItem:ge}),be=L(ge),ve={style:{whiteSpace:"pre-line",width:"500px"}},ye={style:{whiteSpace:"pre-line"}};function _e(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!M(e)}const xe=F(l({__name:"vul",setup(l){const{t:t}=T(),{searchRegister:a}=G(),r=P([{field:"search",label:t("form.input"),component:"Input",formItemProps:{size:"large",style:{width:"100%"}},componentProps:{clearable:!1,slots:{suffix:()=>v(D,{class:"icon-button",onClick:n,text:!0,style:"outline: none;background-color: transparent !important; color: inherit !important; box-shadow: none !important;position: relative;left: 24%"},{default:()=>[v(C,{icon:"tdesign:chat-bubble-help"},null)]})}}}]),s=[{operator:"=",meaning:t("searchHelp.like")},{operator:"!=",meaning:t("searchHelp.notIn")},{operator:"==",meaning:t("searchHelp.equal")},{operator:"&&",meaning:t("searchHelp.and")},{operator:"||",meaning:t("searchHelp.or")},{operator:"()",meaning:t("searchHelp.brackets")}],o=[{keyword:"url",example:'url="http://example.com"',explain:t("searchHelp.url")},{keyword:"vulname",example:'vulname="nginxwebui-runcmd-rce"',explain:t("searchHelp.vulname")},{keyword:"level",example:'level="info',explain:t("searchHelp.level")},{keyword:"matched",example:'matched="https://example.com"',explain:t("searchHelp.matched")},{keyword:"request",example:'request="cmd=whoami"',explain:t("searchHelp.vulRequest")},{keyword:"response",example:'response="root"',explain:t("searchHelp.response")},{keyword:"project",example:'project="Hackerone"',explain:t("searchHelp.project")}],i=N(!1),n=()=>{i.value=!0},p=N(!0),u=N("inline"),f=N("left"),b=N(""),y=e=>{b.value=e.search,M()},_=N(!1),x=P([{field:"index",label:t("tableDemo.index"),type:"index",minWidth:10},{field:"url",label:"URL",minWidth:30},{field:"vulnerability",label:"Vulnerability",minWidth:20},{field:"level",label:"Level",minWidth:10,formatter:(e,l,a)=>{if(null==a)return v("div",null,null);let r="",s="";return 6===a?(r="red",s=t("poc.critical")):5===a?(r="orange",s=t("poc.high")):4===a?(r="yellow",s=t("poc.medium")):3===a?(r="blue",s=t("poc.low")):2===a?(r="green",s=t("poc.info")):1===a&&(r="gray",s=t("poc.unknown")),v(Q,{gutter:20,style:"width: 80%"},{default:()=>[v(X,{span:1},{default:()=>[v(C,{icon:"clarity:circle-solid",color:r},null)]}),v(X,{span:5},{default:()=>[v(le,{type:"info"},_e(s)?s:{default:()=>[s]})]})]})}},{field:"matched",label:"Matched",minWidth:30},{field:"time",label:t("asset.time"),minWidth:20},{field:"action",label:t("tableDemo.action"),formatter:(e,l,a)=>{let r;return v(g,null,[v(V,{type:"primary",onClick:()=>ce(e)},_e(r=t("asset.detail"))?r:{default:()=>[r]})])},minWidth:10}]),{allSchemas:j}=re(x),{tableRegister:w,tableState:S,tableMethods:k}=O({fetchDataApi:async()=>{const{currentPage:e,pageSize:l}=S,t=await((e,l,t)=>se.post({url:"/api/vul/data",data:{search:e,pageIndex:l,pageSize:t}}))(b.value,e.value,l.value);return{list:t.data.list,total:t.data.total}},immediate:!1}),{loading:H,dataList:E,total:U,currentPage:I,pageSize:L}=S,{getList:M}=k;function F(){return{background:"var(--el-fill-color-light)"}}L.value=20,W((()=>{ie(),window.addEventListener("resize",ie)}));const oe=N(0),ie=()=>{const e=window.innerHeight||document.documentElement.clientHeight;oe.value=.7*e},ne=P({URL:"",Vulnerability:"",Level:"",Matched:"",Time:"",Request:"",Response:""}),pe=N(""),ue=N(!1),ce=e=>{const l=e.level;pe.value="";let a="";6===l?(pe.value="red",a=t("poc.critical")):5===l?(pe.value="orange",a=t("poc.high")):4===l?(pe.value="yellow",a=t("poc.medium")):3===l?(pe.value="blue",a=t("poc.low")):2===l?(pe.value="green",a=t("poc.info")):1===l&&(pe.value="gray",a=t("poc.unknown")),ne.Level=a,ne.Vulnerability=e.vulnerability,ne.Matched=e.matched,ne.Time=e.time,ne.URL=e.url,ne.Request=e.request,ne.Response=e.response,ue.value=!0};return(l,n)=>{const b=q("ElScrollbar");return d(),m(g,null,[v(c(e),{style:{height:"80px"}},{default:A((()=>[v(c(B),{schema:r,"is-col":p.value,layout:u.value,"show-reset":!1,"button-position":f.value,"search-loading":_.value,onSearch:y,onReset:y,onRegister:c(a)},null,8,["schema","is-col","layout","button-position","search-loading","onRegister"])])),_:1}),v(c(Q),null,{default:A((()=>[v(c(X),null,{default:A((()=>[v(c(J),null,{default:A((()=>[v(c(Z),{pageSize:c(L),"onUpdate:pageSize":n[0]||(n[0]=e=>$(L)?L.value=e:null),currentPage:c(I),"onUpdate:currentPage":n[1]||(n[1]=e=>$(I)?I.value=e:null),columns:c(j).tableColumns,data:c(E),stripe:"",border:!0,"max-height":oe.value,loading:c(H),resizable:!0,onRegister:c(w),headerCellStyle:F,style:{fontFamily:"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji"}},null,8,["pageSize","currentPage","columns","data","max-height","loading","onRegister"])])),_:1})])),_:1}),v(c(X),{":span":24},{default:A((()=>[v(c(J),null,{default:A((()=>[v(c(K),{pageSize:c(L),"onUpdate:pageSize":n[2]||(n[2]=e=>$(L)?L.value=e:null),currentPage:c(I),"onUpdate:currentPage":n[3]||(n[3]=e=>$(I)?I.value=e:null),"page-sizes":[20,50,100,200,500,1e3],layout:"total, sizes, prev, pager, next, jumper",total:c(U)},null,8,["pageSize","currentPage","total"])])),_:1})])),_:1})])),_:1}),v(c(ae),{modelValue:ue.value,"onUpdate:modelValue":n[4]||(n[4]=e=>ue.value=e),title:c(t)("asset.detail"),center:"",style:{"border-radius":"15px","box-shadow":"5px 5px 10px rgba(0, 0, 0, 0.3)"},width:"70%","max-height":oe.value},{default:A((()=>[v(c(fe),{border:!0,column:2},{default:A((()=>[v(c(be),{label:"URL"},{default:A((()=>[R(z(ne.URL),1)])),_:1}),v(c(be),{label:"Level"},{default:A((()=>[v(c(Q),{gutter:20,style:{width:"80%"}},{default:A((()=>[v(c(X),{span:1},{default:A((()=>[v(c(C),{icon:"clarity:circle-solid",color:pe.value},null,8,["color"])])),_:1}),v(c(X),{span:5},{default:A((()=>[v(c(le),{type:"info"},{default:A((()=>[R(z(ne.Level),1)])),_:1})])),_:1})])),_:1})])),_:1}),v(c(be),{label:"Vulnerability"},{default:A((()=>[R(z(ne.Vulnerability),1)])),_:1}),v(c(be),{label:"Matched"},{default:A((()=>[R(z(ne.Matched),1)])),_:1}),v(c(be),{label:"Time",span:2},{default:A((()=>[R(z(ne.Time),1)])),_:1}),v(c(be),{label:"Request"},{default:A((()=>[v(b,{"max-height":oe.value,"max-width":"maxHeight"},{default:A((()=>[h("div",ve,z(ne.Request),1)])),_:1},8,["max-height"])])),_:1}),v(c(be),{label:"Response"},{default:A((()=>[v(b,{"max-height":oe.value},{default:A((()=>[h("div",ye,z(ne.Response),1)])),_:1},8,["max-height"])])),_:1})])),_:1})])),_:1},8,["modelValue","title","max-height"]),v(c(ae),{modelValue:i.value,"onUpdate:modelValue":n[5]||(n[5]=e=>i.value=e),title:c(t)("common.querysyntax"),center:"",style:{"border-radius":"15px","box-shadow":"5px 5px 10px rgba(0, 0, 0, 0.3)"}},{default:A((()=>[v(c(Q),null,{default:A((()=>[v(c(X),null,{default:A((()=>[v(c(le),{tag:"b",size:"small"},{default:A((()=>[R(z(c(t)("searchHelp.operator")),1)])),_:1}),v(c(te),{direction:"vertical"}),v(c(le),{size:"small",type:"danger"},{default:A((()=>[R(z(c(t)("searchHelp.notice")),1)])),_:1})])),_:1}),v(c(X),{style:{"margin-top":"10px"}},{default:A((()=>[v(c(Y),{headerCellStyle:F,data:s},{default:A((()=>[v(c(ee),{prop:"operator",label:c(t)("searchHelp.operator"),width:"300"},null,8,["label"]),v(c(ee),{prop:"meaning",label:c(t)("searchHelp.meaning")},null,8,["label"])])),_:1})])),_:1}),v(c(X),{style:{"margin-top":"15px"}},{default:A((()=>[v(c(le),{tag:"b",size:"small"},{default:A((()=>[R(z(c(t)("searchHelp.keywords")),1)])),_:1})])),_:1}),v(c(X),{style:{"margin-top":"10px"}},{default:A((()=>[v(c(Y),{headerCellStyle:F,data:o},{default:A((()=>[v(c(ee),{prop:"keyword",label:c(t)("searchHelp.keywords")},null,8,["label"]),v(c(ee),{prop:"example",label:c(t)("searchHelp.example")},null,8,["label"]),v(c(ee),{prop:"explain",label:c(t)("searchHelp.explain")},null,8,["label"])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue","title"])],64)}}}),[["__scopeId","data-v-4f537307"]]);export{xe as default};
